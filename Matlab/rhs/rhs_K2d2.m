function dph = rhs_K2d2(ph, m, omega, alpha)
Z = mean(exp((1:4).*1i.*ph), 1);
r = abs(Z);
ang = angle(Z);

dph0 = (-8).*m.^3.*omega.*cos(2.*alpha+(-1).*ph+(-1).*ang(1)).*r(1)+4.* ...
  m.*omega.^3.*cos(2.*alpha+(-1).*ph+(-1).*ang(1)).*r(1)+18.*m.^3.* ...
  omega.*cos(3.*ph+(-1).*ang(1)).*r(1)+8.*m.^3.*omega.*cos(2.*alpha+ ...
  (-3).*ph+ang(1)).*r(1)+(-4).*m.*omega.^3.*cos(2.*alpha+(-3).*ph+ ...
  ang(1)).*r(1)+4.*m.^3.*omega.*cos(2.*alpha+(-1).*ph+ang(1)).*r(1)+ ...
  16.*m.*omega.^3.*cos(2.*alpha+(-1).*ph+ang(1)).*r(1)+2.*m.^3.* ...
  omega.*cos(ph+ang(1)).*r(1)+8.*m.*omega.^3.*cos(ph+ang(1)).*r(1)+( ...
  -18).*m.^3.*omega.*cos(2.*alpha+ph+ang(1)).*r(1)+4.*m.^3.*omega.* ...
  r(1).^2+16.*m.*omega.^3.*r(1).^2+(-20).*m.^3.*omega.*cos(2.*ph).* ...
  r(1).^2+(-8).*m.*omega.^3.*cos(2.*ph).*r(1).^2+28.*m.^3.*omega.* ...
  cos(2.*alpha+2.*ang(1)).*r(1).^2+4.*m.*omega.^3.*cos(2.*alpha+2.* ...
  ang(1)).*r(1).^2+(-8).*m.^3.*omega.*cos(2.*alpha+(-4).*ph+2.*ang( ...
  1)).*r(1).^2+4.*m.*omega.^3.*cos(2.*alpha+(-4).*ph+2.*ang(1)).*r( ...
  1).^2+(-4).*m.^3.*omega.*cos(2.*alpha+(-2).*ph+2.*ang(1)).*r(1) ...
  .^2+(-16).*m.*omega.^3.*cos(2.*alpha+(-2).*ph+2.*ang(1)).*r(1).^2+ ...
  8.*m.^3.*omega.*cos(2.*alpha+(-1).*ph+ang(1)+(-1).*ang(2)).*r(1).* ...
  r(2)+(-4).*m.*omega.^3.*cos(2.*alpha+(-1).*ph+ang(1)+(-1).*ang(2)) ...
  .*r(1).*r(2)+(-6).*m.^3.*omega.*cos(ph+ang(1)+(-1).*ang(2)).*r(1) ...
  .*r(2)+(-24).*m.*omega.^3.*cos(ph+ang(1)+(-1).*ang(2)).*r(1).*r(2) ...
  +(-2).*m.^3.*omega.*cos(2.*alpha+(-1).*ph+(-1).*ang(1)+ang(2)).*r( ...
  1).*r(2)+(-8).*m.*omega.^3.*cos(2.*alpha+(-1).*ph+(-1).*ang(1)+ ...
  ang(2)).*r(1).*r(2)+2.*m.^3.*omega.*cos(2.*alpha+(-3).*ph+ang(1)+ ...
  ang(2)).*r(1).*r(2)+8.*m.*omega.^3.*cos(2.*alpha+(-3).*ph+ang(1)+ ...
  ang(2)).*r(1).*r(2)+(-28).*m.^3.*omega.*cos(2.*alpha+(-1).*ph+ang( ...
  1)+ang(2)).*r(1).*r(2)+(-4).*m.*omega.^3.*cos(2.*alpha+(-1).*ph+ ...
  ang(1)+ang(2)).*r(1).*r(2)+8.*m.^3.*omega.*cos(ph+(-1).*ang(3)).* ...
  r(3)+(-4).*m.*omega.^3.*cos(ph+(-1).*ang(3)).*r(3)+18.*m.^3.* ...
  omega.*cos(2.*alpha+(-1).*ph+ang(3)).*r(3)+2.*m.^3.*omega.*cos(ph+ ...
  ang(2)+(-1).*ang(3)).*r(2).*r(3)+8.*m.*omega.^3.*cos(ph+ang(2)+( ...
  -1).*ang(3)).*r(2).*r(3)+(-8).*m.^3.*omega.*cos(ph+ang(1)+(-1).* ...
  ang(4)).*r(1).*r(4)+4.*m.*omega.^3.*cos(ph+ang(1)+(-1).*ang(4)).* ...
  r(1).*r(4)+(-8).*m.^4.*r(1).^2.*sin(2.*ph)+4.*m.^2.*omega.^2.*r(1) ...
  .^2.*sin(2.*ph)+2.*m.^4.*r(1).*sin(2.*alpha+(-1).*ph+(-1).*ang(1)) ...
  +(-10).*m.^2.*omega.^2.*r(1).*sin(2.*alpha+(-1).*ph+(-1).*ang(1))+ ...
  6.*m.^4.*r(1).*sin(3.*ph+(-1).*ang(1))+(-12).*m.^2.*omega.^2.*r(1) ...
  .*sin(3.*ph+(-1).*ang(1))+(-2).*m.^4.*r(1).*sin(2.*alpha+(-3).*ph+ ...
  ang(1))+10.*m.^2.*omega.^2.*r(1).*sin(2.*alpha+(-3).*ph+ang(1))+ ...
  12.*m.^4.*r(1).*sin(2.*alpha+(-1).*ph+ang(1))+48.*m.^2.*omega.^2.* ...
  r(1).*sin(2.*alpha+(-1).*ph+ang(1))+2.*m.^4.*r(1).*sin(ph+ang(1))+ ...
  8.*m.^2.*omega.^2.*r(1).*sin(ph+ang(1))+(-6).*m.^4.*r(1).*sin(2.* ...
  alpha+ph+ang(1))+12.*m.^2.*omega.^2.*r(1).*sin(2.*alpha+ph+ang(1)) ...
  +10.*m.^4.*r(1).^2.*sin(2.*alpha+2.*ang(1))+(-14).*m.^2.* ...
  omega.^2.*r(1).^2.*sin(2.*alpha+2.*ang(1))+2.*m.^4.*r(1).^2.*sin( ...
  2.*alpha+(-4).*ph+2.*ang(1))+(-10).*m.^2.*omega.^2.*r(1).^2.*sin( ...
  2.*alpha+(-4).*ph+2.*ang(1))+(-12).*m.^4.*r(1).^2.*sin(2.*alpha+( ...
  -2).*ph+2.*ang(1))+(-48).*m.^2.*omega.^2.*r(1).^2.*sin(2.*alpha+( ...
  -2).*ph+2.*ang(1))+(-2).*m.^4.*r(1).*r(2).*sin(2.*alpha+(-1).*ph+ ...
  ang(1)+(-1).*ang(2))+10.*m.^2.*omega.^2.*r(1).*r(2).*sin(2.*alpha+ ...
  (-1).*ph+ang(1)+(-1).*ang(2))+(-10).*m.^4.*r(1).*r(2).*sin(ph+ang( ...
  1)+(-1).*ang(2))+(-40).*m.^2.*omega.^2.*r(1).*r(2).*sin(ph+ang(1)+ ...
  (-1).*ang(2))+(-2).*m.^4.*r(1).*r(2).*sin(2.*alpha+(-1).*ph+(-1).* ...
  ang(1)+ang(2))+(-8).*m.^2.*omega.^2.*r(1).*r(2).*sin(2.*alpha+(-1) ...
  .*ph+(-1).*ang(1)+ang(2))+2.*m.^4.*r(1).*r(2).*sin(2.*alpha+(-3).* ...
  ph+ang(1)+ang(2))+8.*m.^2.*omega.^2.*r(1).*r(2).*sin(2.*alpha+(-3) ...
  .*ph+ang(1)+ang(2))+(-10).*m.^4.*r(1).*r(2).*sin(2.*alpha+(-1).* ...
  ph+ang(1)+ang(2))+14.*m.^2.*omega.^2.*r(1).*r(2).*sin(2.*alpha+( ...
  -1).*ph+ang(1)+ang(2))+(-2).*m.^4.*r(3).*sin(ph+(-1).*ang(3))+10.* ...
  m.^2.*omega.^2.*r(3).*sin(ph+(-1).*ang(3))+2.*m.^4.*r(2).*r(3).* ...
  sin(ph+ang(2)+(-1).*ang(3))+8.*m.^2.*omega.^2.*r(2).*r(3).*sin(ph+ ...
  ang(2)+(-1).*ang(3))+6.*m.^4.*r(3).*sin(2.*alpha+(-1).*ph+ang(3))+ ...
  (-12).*m.^2.*omega.^2.*r(3).*sin(2.*alpha+(-1).*ph+ang(3))+2.* ...
  m.^4.*r(1).*r(4).*sin(ph+ang(1)+(-1).*ang(4))+(-10).*m.^2.* ...
  omega.^2.*r(1).*r(4).*sin(ph+ang(1)+(-1).*ang(4));

fct0 = -1/(8*m*(m^4 + 5*m^2*omega^2 + 4*omega^4));
dph0 = fct0*dph0;

%% 
dph1 = (-1).*omega+omega.*cos(2.*alpha)+4.*omega.*cos(2.*alpha+(-2).*ph)+ ...
  6.*omega.*cos(2.*ph)+(-2).*omega.*cos(2.*alpha+(-1).*ph+(-1).*ang( ...
  1)).*r(1)+(-3).*omega.*cos(3.*ph+(-1).*ang(1)).*r(1)+(-4).*omega.* ...
  cos(2.*alpha+(-3).*ph+ang(1)).*r(1)+(-4).*omega.*cos(2.*alpha+(-1) ...
  .*ph+ang(1)).*r(1)+(-1).*omega.*cos(ph+ang(1)).*r(1)+3.*omega.* ...
  cos(2.*alpha+ph+ang(1)).*r(1)+2.*omega.*r(1).^2+2.*omega.*cos(2.* ...
  alpha).*r(1).^2+(-2).*omega.*cos(2.*alpha+(-2).*ph).*r(1).^2+(-2) ...
  .*omega.*cos(2.*ph).*r(1).^2+2.*omega.*cos(2.*alpha+(-4).*ph+2.* ...
  ang(1)).*r(1).^2+(-2).*omega.*cos(2.*alpha+(-2).*ph+2.*ang(1)).*r( ...
  1).^2+(-1).*omega.*cos(2.*ph+(-1).*ang(2)).*r(2)+(-3).*omega.*cos( ...
  ang(2)).*r(2)+(-7).*omega.*cos(2.*alpha+ang(2)).*r(2)+3.*omega.* ...
  cos(2.*alpha+(-2).*ph+ang(2)).*r(2)+2.*omega.*cos(2.*alpha+(-1).* ...
  ph+ang(1)+(-1).*ang(2)).*r(1).*r(2)+3.*omega.*cos(ph+ang(1)+(-1).* ...
  ang(2)).*r(1).*r(2)+(-1).*omega.*cos(2.*alpha+(-1).*ph+(-1).*ang( ...
  1)+ang(2)).*r(1).*r(2)+omega.*cos(2.*alpha+(-3).*ph+ang(1)+ang(2)) ...
  .*r(1).*r(2)+2.*omega.*cos(2.*alpha+(-1).*ph+ang(1)+ang(2)).*r(1) ...
  .*r(2)+(-2).*omega.*r(2).^2+omega.*cos(2.*ph).*r(2).^2+(-1).* ...
  omega.*cos(2.*alpha+(-2).*ph+2.*ang(2)).*r(2).^2+2.*omega.*cos(ph+ ...
  (-1).*ang(3)).*r(3)+3.*omega.*cos(2.*alpha+(-1).*ph+ang(3)).*r(3)+ ...
  2.*omega.*cos(ang(1)+(-1).*ang(3)).*r(1).*r(3)+(-2).*omega.*cos( ...
  2.*ph+ang(1)+(-1).*ang(3)).*r(1).*r(3)+omega.*cos(ph+ang(2)+(-1).* ...
  ang(3)).*r(2).*r(3)+(-2).*omega.*cos(ph+ang(1)+(-1).*ang(4)).*r(1) ...
  .*r(4)+5.*m.*sin(2.*alpha)+(-2).*m.*r(1).^2.*sin(2.*alpha)+(-4).* ...
  m.*sin(2.*alpha+(-2).*ph)+2.*m.*r(1).^2.*sin(2.*alpha+(-2).*ph)+ ...
  6.*m.*sin(2.*ph)+(-2).*m.*r(1).^2.*sin(2.*ph)+m.*r(2).^2.*sin(2.* ...
  ph)+2.*m.*r(1).*sin(2.*alpha+(-1).*ph+(-1).*ang(1))+8.*m.*r(1).* ...
  sin(ph+(-1).*ang(1))+(-3).*m.*r(1).*sin(3.*ph+(-1).*ang(1))+4.*m.* ...
  r(1).*sin(2.*alpha+(-3).*ph+ang(1))+(-8).*m.*r(1).*sin(2.*alpha+( ...
  -1).*ph+ang(1))+(-1).*m.*r(1).*sin(ph+ang(1))+3.*m.*r(1).*sin(2.* ...
  alpha+ph+ang(1))+(-2).*m.*r(1).^2.*sin(2.*alpha+(-4).*ph+2.*ang(1) ...
  )+2.*m.*r(1).^2.*sin(2.*alpha+(-2).*ph+2.*ang(1))+(-5).*m.*r(2).* ...
  sin(2.*ph+(-1).*ang(2))+(-2).*m.*r(1).*r(2).*sin(2.*alpha+(-1).* ...
  ph+ang(1)+(-1).*ang(2))+(-3).*m.*r(1).*r(2).*sin(ph+ang(1)+(-1).* ...
  ang(2))+(-3).*m.*r(2).*sin(ang(2))+(-7).*m.*r(2).*sin(2.*alpha+ ...
  ang(2))+7.*m.*r(2).*sin(2.*alpha+(-2).*ph+ang(2))+(-1).*m.*r(1).* ...
  r(2).*sin(2.*alpha+(-1).*ph+(-1).*ang(1)+ang(2))+(-3).*m.*r(1).*r( ...
  2).*sin(2.*alpha+(-3).*ph+ang(1)+ang(2))+2.*m.*r(1).*r(2).*sin(2.* ...
  alpha+(-1).*ph+ang(1)+ang(2))+(-1).*m.*r(2).^2.*sin(2.*alpha+(-2) ...
  .*ph+2.*ang(2))+(-2).*m.*r(3).*sin(ph+(-1).*ang(3))+(-2).*m.*r(1) ...
  .*r(3).*sin(ang(1)+(-1).*ang(3))+2.*m.*r(1).*r(3).*sin(2.*ph+ang( ...
  1)+(-1).*ang(3))+m.*r(2).*r(3).*sin(ph+ang(2)+(-1).*ang(3))+3.*m.* ...
  r(3).*sin(2.*alpha+(-1).*ph+ang(3))+2.*m.*r(1).*r(4).*sin(ph+ang( ...
  1)+(-1).*ang(4));

fct1 = 1/(8*(m^2+omega^2));
dph1 = fct1*dph1;

%%

dph2 = r(1).^2.*sin(2.*alpha)+(-1).*r(1).^2.*sin(2.*alpha+(-2).*ph)+r(1) ...
  .^2.*sin(2.*ph)+(-1).*r(1).*sin(ph+(-1).*ang(1))+2.*r(1).*sin(2.* ...
  alpha+(-3).*ph+ang(1))+(-3).*r(1).*sin(2.*alpha+(-1).*ph+ang(1))+( ...
  -1).*r(1).*sin(ph+ang(1))+r(1).*sin(2.*alpha+ph+ang(1))+(-2).*r(1) ...
  .^2.*sin(2.*alpha+2.*ang(1))+(-1).*r(1).^2.*sin(2.*alpha+(-4).*ph+ ...
  2.*ang(1))+3.*r(1).^2.*sin(2.*alpha+(-2).*ph+2.*ang(1))+3.*r(1).* ...
  r(2).*sin(ph+ang(1)+(-1).*ang(2))+(-1).*r(1).*r(2).*sin(3.*ph+ang( ...
  1)+(-1).*ang(2))+2.*r(1).*r(2).*sin(ph+(-1).*ang(1)+ang(2))+(-1).* ...
  r(1).*r(2).*sin(2.*alpha+(-3).*ph+ang(1)+ang(2))+r(1).*r(2).*sin( ...
  2.*alpha+(-1).*ph+ang(1)+ang(2))+r(1).*r(3).*sin(ang(1)+(-1).*ang( ...
  3))+(-1).*r(1).*r(3).*sin(2.*ph+ang(1)+(-1).*ang(3));

fct2 = 1/(8*m);
dph2 = fct2*dph2;


dph = dph0+dph1+dph2;
   

end