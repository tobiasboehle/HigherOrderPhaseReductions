(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    162057,       4104]
NotebookOptionsPosition[    153085,       3969]
NotebookOutlinePosition[    153521,       3986]
CellTagsIndexPosition[    153478,       3983]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Title of the Paper", "Title",
 CellChangeTimes->{{3.877271496395153*^9, 
  3.8772715566929703`*^9}},ExpressionUUID->"fbcab9dd-becd-415f-bdb5-\
118a66361846"],

Cell["Christian Bick, Tobias B\[ODoubleDot]hle & Christian Kuehn", "Author",
 CellChangeTimes->{{3.877271646578093*^9, 
  3.877271657300338*^9}},ExpressionUUID->"62632b38-10ac-4132-bbd7-\
03f58be76396"],

Cell["\<\
This Mathematica Code is part of the supplementary material for the Paper \
\[OpenCurlyDoubleQuote]Title\[CloseCurlyDoubleQuote], written by Christian \
Bick, Tobias B\[ODoubleDot]hle & Christian Kuehn.\
\>", "Text",
 CellChangeTimes->{
  3.877274316649576*^9},ExpressionUUID->"ec42298c-7030-48c4-baf5-\
1c85d981c792"],

Cell[CellGroupData[{

Cell["Initializations", "Section",
 CellChangeTimes->{{3.877446867249607*^9, 
  3.877446870949894*^9}},ExpressionUUID->"bf98f58a-cd45-489b-ac9e-\
52f01f7ee1a3"],

Cell[TextData[{
 "First, add relevant scripts that we will use, define parameters, variables \
and the differential equation that describes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["R", 
     RowBox[{"(", 
      RowBox[{"1", ",", "\[Star]"}], ")"}]], "(", "\[CurlyPhi]", ")"}], 
   TraditionalForm]],ExpressionUUID->"bcc70f7e-a3c2-4ca8-8c57-84de2299e40e"]
}], "Text",
 CellChangeTimes->{{3.877271714713861*^9, 3.877271721667572*^9}, {
  3.8772718251398897`*^9, 3.877271923802997*^9}, {3.8772719934669447`*^9, 
  3.877272067526181*^9}, {3.877272104743259*^9, 
  3.877272104743348*^9}},ExpressionUUID->"e32d75b3-9834-46bf-838f-\
e35ae84105c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Num", " ", "=", " ", "3"}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "is", " ", "the", " ", "number", " ", "of", " ", 
     RowBox[{"oscillators", ".", " ", "The"}], " ", "more", " ", 
     "oscillators"}], ",", " ", 
    RowBox[{
    "the", " ", "longer", " ", "the", " ", "calculation", " ", "takes"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uniquelistphi", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Unique", "[", "\"\<x\>\"", "]"}], ",", " ", 
     RowBox[{"{", "Num", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", "<=", " ", "Num"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", "i", "]"}], "=", " ", 
      RowBox[{"uniquelistphi", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phis", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{"\[Phi]", ",", " ", "Num"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"g", "[", "p_", "]"}], " ", ":=", 
    RowBox[{"Sin", "[", "p", "]"}]}], ";"}], "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Gk", "[", 
      RowBox[{"phis", "/.", " ", 
       RowBox[{"List", "->", " ", "Sequence"}]}], "]"}], " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]", " ", 
             RowBox[{"g", "[", 
              RowBox[{"\[Phi]", "[", "l", "]"}], "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]", " ", 
             RowBox[{"g", "[", 
              RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "l", "]"}], "-", 
           RowBox[{"\[Phi]", "[", "k", "]"}], "+", "\[Alpha]"}], "]"}]}], "-", 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", "-", " ", 
        RowBox[{"\[Delta]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "'"}], "[", 
           RowBox[{"\[Phi]", "[", "k", "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]", " ", 
             RowBox[{"g", "[", 
              RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "l", "]"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}]}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "l", "]"}], "-", 
              RowBox[{"\[Phi]", "[", "k", "]"}], "+", "\[Alpha]"}], "]"}]}], 
           "-", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ")"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffeqalldexp", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"m", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Delta]", " ", 
          RowBox[{"g", "[", 
           RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}], "^", "2"}], 
      "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Delta]", "^", "i"}], "*", 
         RowBox[{
          RowBox[{"R", "[", "i", "]"}], "[", 
          RowBox[{"phis", "/.", " ", 
           RowBox[{"List", "->", "Sequence"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"1", "/", "Num"}], " ", "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]", " ", 
              RowBox[{"g", "[", 
               RowBox[{"\[Phi]", "[", "l", "]"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]", " ", 
              RowBox[{"g", "[", 
               RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}]}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "l", "]"}], "-", 
            RowBox[{"\[Phi]", "[", "k", "]"}], "+", "\[Alpha]"}], "]"}]}], 
         "-", 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}], "-", 
         RowBox[{"\[Delta]", " ", 
          RowBox[{
           RowBox[{"g", "'"}], "[", 
           RowBox[{"\[Phi]", "[", "k", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Delta]", " ", 
                 RowBox[{"g", "[", 
                  RowBox[{"\[Phi]", "[", "l", "]"}], "]"}]}]}], ")"}], "/", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Delta]", " ", 
                  RowBox[{"g", "[", 
                   RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}], "^", 
               "2"}]}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "[", "l", "]"}], "-", 
               RowBox[{"\[Phi]", "[", "k", "]"}], "+", "\[Alpha]"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "k", "]"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], "==", " ", 
    RowBox[{"\[Omega]", "*", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Delta]", "^", "i"}], "*", 
            RowBox[{
             RowBox[{"R", "[", "i", "]"}], "[", 
             RowBox[{"phis", "/.", " ", 
              RowBox[{"List", "->", "Sequence"}]}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"\[Phi]", "[", "l", "]"}]}], " ", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8701752093917723`*^9, 3.87017521164074*^9}, {
   3.8701758149866247`*^9, 3.870175818734391*^9}, {3.870185575331648*^9, 
   3.8701855769736023`*^9}, {3.8701860793590927`*^9, 
   3.8701860820271072`*^9}, {3.870329974124221*^9, 3.870330001145863*^9}, {
   3.870332428113678*^9, 3.87033246459169*^9}, {3.870332752815921*^9, 
   3.870332764421793*^9}, {3.8703328127942247`*^9, 3.870332830981517*^9}, {
   3.870333218075842*^9, 3.870333332274547*^9}, {3.870333391650725*^9, 
   3.870333485784657*^9}, {3.870333537739044*^9, 3.870333559520356*^9}, {
   3.870333608919969*^9, 3.870333611775688*^9}, {3.87033366338627*^9, 
   3.870333677271099*^9}, {3.870333737180058*^9, 3.87033376218813*^9}, {
   3.8703337931604633`*^9, 3.870333802878915*^9}, {3.8703338550647287`*^9, 
   3.8703339182910223`*^9}, {3.870335475059784*^9, 3.870335538401285*^9}, {
   3.8703355694182997`*^9, 3.87033561686569*^9}, {3.8703356873529587`*^9, 
   3.8703356873842278`*^9}, {3.870335825729023*^9, 3.8703358258546333`*^9}, {
   3.8703412816315947`*^9, 3.870341285028994*^9}, {3.870341318437242*^9, 
   3.8703414871102037`*^9}, 3.870341544999609*^9, {3.8703418799231977`*^9, 
   3.870341880080305*^9}, {3.870347356158202*^9, 3.870347356707941*^9}, {
   3.870492933691628*^9, 3.87049293395022*^9}, {3.8704929921818132`*^9, 
   3.870493017270111*^9}, {3.8704940471386757`*^9, 3.87049412381511*^9}, {
   3.870674644515217*^9, 3.870674731472815*^9}, {3.8706861767984257`*^9, 
   3.870686203327503*^9}, {3.87068624372116*^9, 3.870686264239286*^9}, 
   3.870686341934602*^9, {3.8706863799362173`*^9, 3.870686379987349*^9}, {
   3.870686413681649*^9, 3.8706864192840776`*^9}, {3.870686480352724*^9, 
   3.8706864829635983`*^9}, {3.870686575873826*^9, 3.870686610031323*^9}, {
   3.870686643617282*^9, 3.8706866617464542`*^9}, {3.870686699857285*^9, 
   3.870686726273945*^9}, {3.870687680235119*^9, 3.870687715738598*^9}, {
   3.8706877469226637`*^9, 3.8706877469417353`*^9}, {3.870688568921054*^9, 
   3.870688568953624*^9}, {3.871552259433524*^9, 3.871552259486731*^9}, {
   3.871553575767105*^9, 3.871553579163259*^9}, {3.871555938606455*^9, 
   3.871555938686205*^9}, {3.871556683803164*^9, 3.871556760233186*^9}, {
   3.871621336240548*^9, 3.8716213480198793`*^9}, {3.872053842298212*^9, 
   3.872053882059361*^9}, {3.8720571992851057`*^9, 3.87205723233055*^9}, {
   3.872135684995208*^9, 3.872135686951598*^9}, {3.872135729144342*^9, 
   3.872135738528946*^9}, {3.8721369560815277`*^9, 3.872136958340955*^9}, {
   3.872137550624198*^9, 3.872137552266086*^9}, {3.872666378884516*^9, 
   3.8726663900612803`*^9}, {3.8726705567423763`*^9, 3.872670635042297*^9}, {
   3.872675642317865*^9, 3.872675646929578*^9}, {3.872679904127597*^9, 
   3.872679905482874*^9}, {3.872688960135159*^9, 3.872688962905583*^9}, {
   3.872929797078723*^9, 3.872929821665882*^9}, {3.872929854048665*^9, 
   3.8729299136380577`*^9}, {3.872930144368429*^9, 3.8729303190116663`*^9}, {
   3.872931384196596*^9, 3.8729314382702436`*^9}, {3.873084203424943*^9, 
   3.873084218268879*^9}, {3.873084250031868*^9, 3.873084299045608*^9}, {
   3.873084956252204*^9, 3.873084980959817*^9}, {3.8730859433856*^9, 
   3.873085946726349*^9}, {3.873086140431082*^9, 3.873086162794935*^9}, {
   3.873086359542602*^9, 3.873086375377797*^9}, {3.873086425461439*^9, 
   3.873086488178278*^9}, 3.873095248088305*^9, {3.873103896232053*^9, 
   3.873103896256765*^9}, {3.8731063771900063`*^9, 3.873106381757184*^9}, {
   3.873269243129554*^9, 3.873269244547409*^9}, {3.873288613154977*^9, 
   3.873288633756649*^9}, {3.873345333364305*^9, 3.873345333971236*^9}, {
   3.873345393839587*^9, 3.873345434277444*^9}, {3.873345611135202*^9, 
   3.873345630636599*^9}, {3.873345708250805*^9, 3.873345780539177*^9}, {
   3.873360346661228*^9, 3.873360402286727*^9}, {3.873360461911528*^9, 
   3.87336049046166*^9}, {3.873362263818183*^9, 3.873362275948144*^9}, {
   3.873362747573145*^9, 3.873362782465473*^9}, {3.8733630487307167`*^9, 
   3.8733631509101*^9}, {3.873363522013349*^9, 3.873363523319262*^9}, {
   3.873363899768422*^9, 3.8733639329123077`*^9}, {3.873363975641613*^9, 
   3.873363978546308*^9}, {3.873364265100835*^9, 3.873364265559082*^9}, {
   3.8741244245388937`*^9, 3.8741244297969437`*^9}, {3.874379852202035*^9, 
   3.874379873255314*^9}, {3.874379968488762*^9, 3.8743799723340797`*^9}, {
   3.874380035057624*^9, 3.874380231095207*^9}, {3.874380424305912*^9, 
   3.8743804340077143`*^9}, {3.874380490175437*^9, 3.874380521219512*^9}, {
   3.874380564850554*^9, 3.874380566064093*^9}, {3.87446244863393*^9, 
   3.874462448817429*^9}, 3.874462496570129*^9, {3.874484309224497*^9, 
   3.8744843092768917`*^9}, {3.874488915414168*^9, 3.8744889572378893`*^9}, {
   3.874488998270439*^9, 3.87448899843394*^9}, {3.8744890434378633`*^9, 
   3.874489045234776*^9}, {3.87448911254734*^9, 3.8744891531889477`*^9}, 
   3.874489236404356*^9, {3.874489335964877*^9, 3.874489336110042*^9}, {
   3.874489574307046*^9, 3.874489578862915*^9}, {3.8744896114396267`*^9, 
   3.874489613668128*^9}, 3.874491149573029*^9, {3.8744918221184473`*^9, 
   3.874491824461581*^9}, {3.874641635481777*^9, 3.874641637233418*^9}, 
   3.876563736202524*^9, {3.876564000952909*^9, 3.8765640009889507`*^9}, {
   3.876564186671299*^9, 3.876564186774394*^9}, {3.876568982876774*^9, 
   3.8765689847327538`*^9}, 3.876569167308879*^9, {3.876571914526173*^9, 
   3.876571914711296*^9}, {3.876572060117425*^9, 3.8765720604161*^9}, {
   3.876649367007552*^9, 3.876649367170389*^9}, {3.8766555799713793`*^9, 
   3.876655580025251*^9}, {3.876996492982411*^9, 3.876996493048044*^9}, {
   3.8771643863845663`*^9, 3.8771643877430077`*^9}, 3.877271690833519*^9, {
   3.877271746057805*^9, 3.877271749082222*^9}, {3.877271788455244*^9, 
   3.877271816343802*^9}, {3.8772718670810757`*^9, 3.877271870831707*^9}, {
   3.8787040959401817`*^9, 3.878704097763432*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ba178e41-f9a1-4da6-a62b-0497915708ca"],

Cell[TextData[{
 "Next, we define a Rule, that can be used to replace large sums of \
trigonometric functions with shorter sums, that use order parameters. For \
example the formula ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["1", "Num"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "1"}], "Num"], 
     RowBox[{"sin", "(", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", "j"], "-", 
       SubscriptBox["\[CurlyPhi]", "k"]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"9807748b-9f03-4ecf-95af-9e1fb35c5556"],
 " can be written as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"R", "[", "1", "]"}], 
    RowBox[{"sin", "(", 
     RowBox[{
      RowBox[{"ang", "[", "1", "]"}], "-", 
      SubscriptBox["\[CurlyPhi]", "k"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"556e78e5-c2ea-4e8c-9bd0-933a51ff92a8"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"R", "[", "1", "]"}], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"ang", "[", "1", "]"}]}]]}], "=", 
    RowBox[{
     FractionBox["1", "Num"], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"j", "=", "1"}], "Num"], 
      RowBox[{"sin", "(", 
       SubscriptBox["\[CurlyPhi]", "j"], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d2dc0160-567f-4858-92ef-7257647e4568"],
 ". "
}], "Text",
 CellChangeTimes->{{3.8772721827644663`*^9, 3.877272449266244*^9}, {
  3.877272696689951*^9, 3.87727273973422*^9}, {3.877272775174571*^9, 
  3.877273026164935*^9}},ExpressionUUID->"5ec3d5cb-ef72-4217-bab0-\
ab8d59f0d836"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderParamRepRule", "[", 
   RowBox[{"arg_", ",", "fun_", ",", " ", "sumarg_"}], "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ret", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"arg", " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{"Plus", "->", " ", "List"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", "ret", "}"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"ret", ",", 
        RowBox[{"{", 
         RowBox[{"Times", "->", " ", "List"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Replace", "[", 
       RowBox[{"ret", ",", " ", 
        RowBox[{"ss_Symbol", "->", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "ss"}], "}"}]}], ",", " ", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Replace", "[", 
       RowBox[{"ret", ",", " ", 
        RowBox[{"ss_ang", "->", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "ss"}], "}"}]}], ",", " ", 
        RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pref", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", "<=", " ", 
        RowBox[{"Length", "[", "ret", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "==", " ", 
           "sumarg"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"int", " ", "=", " ", 
            RowBox[{"Abs", "[", 
             RowBox[{"ret", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "/", "int"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"ang", "[", "int", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pref", " ", "=", " ", 
            RowBox[{"pref", "*", " ", 
             RowBox[{"r", "[", "int", "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"l", ",", 
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", " ", "l"}], "]"}]}], "]"}], ",", "ret"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ret", " ", "=", " ", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", " ", "ret"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pref", "*", 
      RowBox[{"fun", "[", "ret", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8701752093917723`*^9, 3.87017521164074*^9}, {
   3.8701758149866247`*^9, 3.870175818734391*^9}, {3.870185575331648*^9, 
   3.8701855769736023`*^9}, {3.8701860793590927`*^9, 
   3.8701860820271072`*^9}, {3.870329974124221*^9, 3.870330001145863*^9}, {
   3.870332428113678*^9, 3.87033246459169*^9}, {3.870332752815921*^9, 
   3.870332764421793*^9}, {3.8703328127942247`*^9, 3.870332830981517*^9}, {
   3.870333218075842*^9, 3.870333332274547*^9}, {3.870333391650725*^9, 
   3.870333485784657*^9}, {3.870333537739044*^9, 3.870333559520356*^9}, {
   3.870333608919969*^9, 3.870333611775688*^9}, {3.87033366338627*^9, 
   3.870333677271099*^9}, {3.870333737180058*^9, 3.87033376218813*^9}, {
   3.8703337931604633`*^9, 3.870333802878915*^9}, {3.8703338550647287`*^9, 
   3.8703339182910223`*^9}, {3.870335475059784*^9, 3.870335538401285*^9}, {
   3.8703355694182997`*^9, 3.87033561686569*^9}, {3.8703356873529587`*^9, 
   3.8703356873842278`*^9}, {3.870335825729023*^9, 3.8703358258546333`*^9}, {
   3.8703412816315947`*^9, 3.870341285028994*^9}, {3.870341318437242*^9, 
   3.8703414871102037`*^9}, 3.870341544999609*^9, {3.8703418799231977`*^9, 
   3.870341880080305*^9}, {3.870347356158202*^9, 3.870347356707941*^9}, {
   3.870492933691628*^9, 3.87049293395022*^9}, {3.8704929921818132`*^9, 
   3.870493017270111*^9}, {3.8704940471386757`*^9, 3.87049412381511*^9}, {
   3.870674644515217*^9, 3.870674731472815*^9}, {3.8706861767984257`*^9, 
   3.870686203327503*^9}, {3.87068624372116*^9, 3.870686264239286*^9}, 
   3.870686341934602*^9, {3.8706863799362173`*^9, 3.870686379987349*^9}, {
   3.870686413681649*^9, 3.8706864192840776`*^9}, {3.870686480352724*^9, 
   3.8706864829635983`*^9}, {3.870686575873826*^9, 3.870686610031323*^9}, {
   3.870686643617282*^9, 3.8706866617464542`*^9}, {3.870686699857285*^9, 
   3.870686726273945*^9}, {3.870687680235119*^9, 3.870687715738598*^9}, {
   3.8706877469226637`*^9, 3.8706877469417353`*^9}, {3.870688568921054*^9, 
   3.870688568953624*^9}, {3.871552259433524*^9, 3.871552259486731*^9}, {
   3.871553575767105*^9, 3.871553579163259*^9}, {3.871555938606455*^9, 
   3.871555938686205*^9}, {3.871556683803164*^9, 3.871556760233186*^9}, {
   3.871621336240548*^9, 3.8716213480198793`*^9}, {3.872053842298212*^9, 
   3.872053882059361*^9}, {3.8720571992851057`*^9, 3.87205723233055*^9}, {
   3.872135684995208*^9, 3.872135686951598*^9}, {3.872135729144342*^9, 
   3.872135738528946*^9}, {3.8721369560815277`*^9, 3.872136958340955*^9}, {
   3.872137550624198*^9, 3.872137552266086*^9}, {3.872666378884516*^9, 
   3.8726663900612803`*^9}, {3.8726705567423763`*^9, 3.872670635042297*^9}, {
   3.872675642317865*^9, 3.872675646929578*^9}, {3.872679904127597*^9, 
   3.872679905482874*^9}, {3.872688960135159*^9, 3.872688962905583*^9}, {
   3.872929797078723*^9, 3.872929821665882*^9}, {3.872929854048665*^9, 
   3.8729299136380577`*^9}, {3.872930144368429*^9, 3.8729303190116663`*^9}, {
   3.872931384196596*^9, 3.8729314382702436`*^9}, {3.873084203424943*^9, 
   3.873084218268879*^9}, {3.873084250031868*^9, 3.873084299045608*^9}, {
   3.873084956252204*^9, 3.873084980959817*^9}, {3.8730859433856*^9, 
   3.873085946726349*^9}, {3.873086140431082*^9, 3.873086162794935*^9}, {
   3.873086359542602*^9, 3.873086375377797*^9}, {3.873086425461439*^9, 
   3.873086488178278*^9}, 3.873095248088305*^9, {3.873103896232053*^9, 
   3.873103896256765*^9}, {3.8731063771900063`*^9, 3.873106381757184*^9}, {
   3.873269243129554*^9, 3.873269244547409*^9}, {3.873288613154977*^9, 
   3.873288633756649*^9}, {3.873345333364305*^9, 3.873345333971236*^9}, {
   3.873345393839587*^9, 3.873345434277444*^9}, {3.873345611135202*^9, 
   3.873345630636599*^9}, {3.873345708250805*^9, 3.873345780539177*^9}, {
   3.873360346661228*^9, 3.873360402286727*^9}, {3.873360461911528*^9, 
   3.87336049046166*^9}, {3.873362263818183*^9, 3.873362275948144*^9}, {
   3.873362747573145*^9, 3.873362782465473*^9}, {3.8733630487307167`*^9, 
   3.8733631509101*^9}, {3.873363522013349*^9, 3.873363523319262*^9}, {
   3.873363899768422*^9, 3.8733639329123077`*^9}, {3.873363975641613*^9, 
   3.873363978546308*^9}, {3.873364265100835*^9, 3.873364265559082*^9}, {
   3.8741244245388937`*^9, 3.8741244297969437`*^9}, {3.874379852202035*^9, 
   3.874379873255314*^9}, {3.874379968488762*^9, 3.8743799723340797`*^9}, {
   3.874380035057624*^9, 3.874380231095207*^9}, {3.874380424305912*^9, 
   3.8743804340077143`*^9}, {3.874380490175437*^9, 3.874380521219512*^9}, {
   3.874380564850554*^9, 3.874380566064093*^9}, {3.87446244863393*^9, 
   3.874462448817429*^9}, 3.874462496570129*^9, {3.874484309224497*^9, 
   3.8744843092768917`*^9}, {3.874488915414168*^9, 3.8744889572378893`*^9}, {
   3.874488998270439*^9, 3.87448899843394*^9}, {3.8744890434378633`*^9, 
   3.874489045234776*^9}, {3.87448911254734*^9, 3.8744891531889477`*^9}, 
   3.874489236404356*^9, {3.874489335964877*^9, 3.874489336110042*^9}, {
   3.874489574307046*^9, 3.874489578862915*^9}, {3.8744896114396267`*^9, 
   3.874489613668128*^9}, 3.874491149573029*^9, {3.8744918221184473`*^9, 
   3.874491824461581*^9}, {3.874641635481777*^9, 3.874641637233418*^9}, 
   3.876563736202524*^9, {3.876564000952909*^9, 3.8765640009889507`*^9}, {
   3.876564186671299*^9, 3.876564186774394*^9}, {3.876568982876774*^9, 
   3.8765689847327538`*^9}, 3.876569167308879*^9, {3.876571914526173*^9, 
   3.876571914711296*^9}, {3.876572060117425*^9, 3.8765720604161*^9}, {
   3.876649367007552*^9, 3.876649367170389*^9}, {3.8766555799713793`*^9, 
   3.876655580025251*^9}, {3.876996492982411*^9, 3.876996493048044*^9}, {
   3.8771643863845663`*^9, 3.8771643877430077`*^9}, 3.877271690833519*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"33c9064d-8cbb-4ce0-b229-8d65650ba6d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving the PDEs", "Section",
 CellChangeTimes->{{3.877446882999546*^9, 
  3.877446891230091*^9}},ExpressionUUID->"520485af-971a-404f-985f-\
180c1aa57d01"],

Cell[TextData[{
 "The next cell contains the actual calculation process. It calculates the \
solution of the PDE for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["R", "k"], 
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}]], "(", "\[CurlyPhi]", ")"}], ",", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["R", "k"], 
       RowBox[{"(", 
        RowBox[{"1", ",", "1"}], ")"}]], "(", "\[CurlyPhi]", ")"}], " ", 
     "and", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["R", "k"], 
        RowBox[{"(", 
         RowBox[{"1", ",", "2"}], ")"}]], "(", "\[CurlyPhi]", ")"}], 
      "."}]}]}], TraditionalForm]],ExpressionUUID->
  "dc13ffd9-a2f0-4acc-a98a-9b338911a4ee"],
 " The first part in the for loop solves the PDE, the second part checks if \
the boundary conditions are satisfied and the third part splits the solutions \
into sums of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["R", "k"], 
      RowBox[{"(", 
       RowBox[{"1", ",", "0"}], ")"}]], "(", "\[CurlyPhi]", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"fct", "[", "0", "]"}]], 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"l", "=", "1"}], "Num"], 
      RowBox[{
       RowBox[{"s", "[", "0", "]"}], "[", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "k"], ",", " ", 
        SubscriptBox["\[CurlyPhi]", "l"]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"6d16a936-92d4-4ff0-884f-f3c177fdf8e2"],
 " and calculates s[0], s[1] and s[2]. On each order, the output will be: The \
solution to the PDE on the respective order in \[Delta], the boundary \
conditions (if they are satisfied, the output should be an array of zeros), \
and the summands s[0], s[1] and s[2], respectively."
}], "Text",
 CellChangeTimes->{{3.8772731243669453`*^9, 3.877273192965232*^9}, {
  3.877273254883687*^9, 3.8772732646270514`*^9}, {3.877273329987589*^9, 
  3.87727361488943*^9}, {3.877274132062245*^9, 
  3.877274202565795*^9}},ExpressionUUID->"24f8461c-2a3e-486f-a2c4-\
976bc9336e4b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fct", "[", "0", "]"}], " ", "=", " ", 
    RowBox[{"Num", "*", "m"}]}], ";", " ", 
   RowBox[{
    RowBox[{"fct", "[", "1", "]"}], " ", "=", " ", 
    RowBox[{"2", "*", "Num", " ", "*", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"m", "^", "2"}], " ", "+", " ", 
       RowBox[{"\[Omega]", "^", "2"}]}], ")"}]}]}], ";", " ", 
   RowBox[{
    RowBox[{"fct", "[", "2", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "4"}], "*", "Num", "*", "m", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", "^", "4"}], "+", 
       RowBox[{"5", "*", 
        RowBox[{"m", "^", "2"}], 
        RowBox[{"\[Omega]", "^", "2"}]}], "+", 
       RowBox[{"4", 
        RowBox[{"\[Omega]", "^", "4"}]}]}], ")"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"These", " ", "are", " ", "prefactors"}], ",", " ", 
    RowBox[{
    "that", " ", "will", " ", "simplify", " ", "the", " ", "output"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Function", "::", "fpct"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"dord", "=", "0"}], ",", " ", 
    RowBox[{"dord", "<=", " ", "2"}], ",", " ", 
    RowBox[{"dord", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Order \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", "dord", "]"}], " ", "<>", " ", 
          "\"\< in \[Delta] \
==============================================================================\
=======================\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Solve", " ", "PDE"}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prevsols", "[", "dord", "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sol", "[", "i", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"dord", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eq", "[", "dord", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"diffeqalldexp", "/.", " ", 
            RowBox[{"Prevsols", "[", "dord", "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Delta]", ",", " ", "dord"}], "}"}]}], "]"}], "/.", " ", 
         RowBox[{"\[Delta]", "->", " ", "0"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "[", "dord", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"DSolve", "[", 
          RowBox[{
           RowBox[{"eq", "[", "dord", "]"}], ",", " ", 
           RowBox[{"R", "[", "dord", "]"}], ",", " ", "phis"}], "]"}], "/.", 
         " ", 
         RowBox[{
          RowBox[{
           TemplateBox[{"1"},
            "C"], "[", "x__", "]"}], "->", " ", "0"}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"solVal", "[", "dord", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"R", "[", "dord", "]"}], "/.", " ", 
         RowBox[{
          RowBox[{"sol", "[", "dord", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"RSol", "[", "dord", "]"}], "[", "p__", "]"}], " ", "=", 
        "  ", 
        RowBox[{"emptybody", "/.", " ", 
         RowBox[{"emptybody", "->", " ", 
          RowBox[{
           RowBox[{"solVal", "[", "dord", "]"}], "[", "p", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"sol", "[", "dord", "]"}], "]"}], ";"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "boundary", " ", "conditions"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bcs", "[", "dord", "]"}], " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RSol", "[", "dord", "]"}], "[", 
            RowBox[{"phis", "/.", " ", 
             RowBox[{"List", "->", " ", "Sequence"}]}], "]"}], "-", 
           RowBox[{
            RowBox[{"RSol", "[", "dord", "]"}], "[", 
            RowBox[{
             RowBox[{"phis", " ", "+", " ", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{"UnitVector", "[", 
                RowBox[{"Num", ",", "i"}], "]"}]}]}], "/.", " ", 
             RowBox[{"List", "->", " ", "Sequence"}]}], "]"}]}], "//", " ", 
          "Simplify"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"bcs", "[", "dord", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Split", " ", "into", " ", "Sum"}], "*)"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "[", "dord", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fct", "[", "dord", "]"}], "*", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"RSol", "[", "dord", "]"}], "[", 
               RowBox[{"phis", "/.", " ", 
                RowBox[{"List", "->", " ", "Sequence"}]}], "]"}], ",", " ", 
              RowBox[{"\[Phi]", "[", "2", "]"}]}], "]"}], ",", " ", 
            RowBox[{"\[Phi]", "[", "2", "]"}]}], "]"}]}], ")"}], " ", "//", 
        "Simplify"}], " ", "//", " ", "Expand"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"temp", "[", "dord", "]"}], "[", 
       RowBox[{"xk_", ",", " ", "xl_"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"f", "[", "dord", "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Phi]", "[", "1", "]"}], "->", " ", "xk"}], ",", " ", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "2", "]"}], "->", " ", "xl"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", "dord", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "Num"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"fct", "[", "dord", "]"}], "*", 
           RowBox[{
            RowBox[{"RSol", "[", "dord", "]"}], "[", 
            RowBox[{"phis", "/.", " ", 
             RowBox[{"List", "->", " ", "Sequence"}]}], "]"}]}], "-", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"temp", "[", "dord", "]"}], "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "k", "]"}], ",", 
              RowBox[{"\[Phi]", "[", "l", "]"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], ")"}]}], 
       " ", "//", " ", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "dord", "]"}], "[", 
       RowBox[{"xk_", ",", " ", "xl_"}], "]"}], " ", "=", " ", 
      RowBox[{"TrigReduce", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"temp", "[", "dord", "]"}], "[", 
          RowBox[{"xk", ",", "xl"}], "]"}], "+", 
         RowBox[{"a", "[", "dord", "]"}]}], "/.", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "[", "1", "]"}], "->", " ", "xk"}], ",", " ", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "2", "]"}], "->", " ", "xl"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"s", "[", "dord", "]"}], "[", 
       RowBox[{"xk", ",", "xl"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.873085009312016*^9, 3.8730850461488*^9}, {
   3.8730858090968113`*^9, 3.87308581456129*^9}, {3.8730860157696247`*^9, 
   3.87308601892767*^9}, {3.873086193724679*^9, 3.87308621818331*^9}, {
   3.8730874005733223`*^9, 3.873087428609363*^9}, {3.873095117525818*^9, 
   3.8730951382136717`*^9}, {3.8732732807963142`*^9, 3.873273361521772*^9}, {
   3.873288569918549*^9, 3.873288572379201*^9}, {3.873288896754293*^9, 
   3.873288898507112*^9}, {3.873346108333692*^9, 3.8733461587868013`*^9}, {
   3.873360504541169*^9, 3.8733606129291286`*^9}, {3.873360649500114*^9, 
   3.87336077745485*^9}, {3.873360839699358*^9, 3.873360976599978*^9}, {
   3.873361072141982*^9, 3.8733611320865726`*^9}, {3.873361197491057*^9, 
   3.873361218678458*^9}, {3.873361260637253*^9, 3.873361271423141*^9}, {
   3.873361319127186*^9, 3.87336138503293*^9}, {3.873361507681539*^9, 
   3.873361508564843*^9}, {3.87336166219838*^9, 3.8733616742107697`*^9}, {
   3.8733617345662613`*^9, 3.873361801076323*^9}, {3.87336197075408*^9, 
   3.873361977295463*^9}, {3.873362230715749*^9, 3.8733622553623533`*^9}, {
   3.873364000308733*^9, 3.873364005745772*^9}, {3.8733644940697823`*^9, 
   3.87336449596626*^9}, {3.8738613269031982`*^9, 3.873861326977139*^9}, {
   3.873861373503813*^9, 3.873861374025338*^9}, {3.873861689638205*^9, 
   3.873861700788488*^9}, {3.87386173262171*^9, 3.873861743210875*^9}, {
   3.87412449269676*^9, 3.8741244973432083`*^9}, {3.874124529350545*^9, 
   3.874124539404461*^9}, {3.874137921212435*^9, 3.8741379227255917`*^9}, {
   3.874462437404681*^9, 3.874462437488701*^9}, {3.874489021971773*^9, 
   3.874489066851268*^9}, {3.8744892417698317`*^9, 3.874489278795032*^9}, {
   3.8744895848890676`*^9, 3.87448958497546*^9}, {3.874491100699815*^9, 
   3.874491130381665*^9}, 3.8744911607146063`*^9, {3.874491248654962*^9, 
   3.874491263329612*^9}, {3.874491553477906*^9, 3.8744917764038563`*^9}, {
   3.874491831482843*^9, 3.874491831620634*^9}, {3.87464166484904*^9, 
   3.874641666943609*^9}, {3.8746417868422947`*^9, 3.8746417874007883`*^9}, {
   3.874642102693264*^9, 3.874642129581518*^9}, {3.8746425137755127`*^9, 
   3.874642513928529*^9}, {3.874646150739249*^9, 3.8746462260728483`*^9}, {
   3.874646416262582*^9, 3.87464641998275*^9}, {3.8746464945541773`*^9, 
   3.874646521046792*^9}, {3.874646649647636*^9, 3.8746466553805723`*^9}, {
   3.874646708737277*^9, 3.874646744691821*^9}, {3.874647241874928*^9, 
   3.874647246603217*^9}, {3.874647383918065*^9, 3.8746473970450563`*^9}, {
   3.874647448095158*^9, 3.8746474494979362`*^9}, {3.874647481296894*^9, 
   3.87464748689611*^9}, {3.87464804161023*^9, 3.874648069309675*^9}, 
   3.874648125567256*^9, {3.874648240174077*^9, 3.874648267849064*^9}, {
   3.87464832431919*^9, 3.874648348731903*^9}, {3.874648394386015*^9, 
   3.874648422730864*^9}, {3.874648475962521*^9, 3.874648484662258*^9}, {
   3.874648538533122*^9, 3.874648561216975*^9}, {3.874649779120363*^9, 
   3.874649779858132*^9}, {3.87464982133541*^9, 3.874649836529951*^9}, {
   3.874653752467823*^9, 3.87465375719765*^9}, 3.874653960421961*^9, {
   3.874654046197447*^9, 3.874654046713937*^9}, {3.8746543016505337`*^9, 
   3.874654349209382*^9}, {3.8746543927534027`*^9, 3.874654398265089*^9}, {
   3.874654434044261*^9, 3.874654464492035*^9}, {3.874654519110531*^9, 
   3.87465455604213*^9}, 3.874654803059182*^9, 3.8746548595922737`*^9, {
   3.874655003917486*^9, 3.874655029446844*^9}, 3.874655166918249*^9, {
   3.874655310803096*^9, 3.874655412866746*^9}, {3.874655467195169*^9, 
   3.8746555387714367`*^9}, {3.874655571283824*^9, 3.8746556055233393`*^9}, {
   3.874655637266444*^9, 3.874655643339575*^9}, {3.874658633980459*^9, 
   3.8746586514493427`*^9}, {3.874658692000722*^9, 3.874658710384197*^9}, {
   3.874658944838832*^9, 3.874658947445963*^9}, {3.874658996617373*^9, 
   3.874658996806498*^9}, {3.874660468488093*^9, 3.874660503647277*^9}, {
   3.874660665847014*^9, 3.874660666089175*^9}, {3.874661011352969*^9, 
   3.8746610141302567`*^9}, {3.874661064734024*^9, 3.8746610835286837`*^9}, {
   3.87472587073604*^9, 3.8747258709645567`*^9}, {3.876563172077602*^9, 
   3.876563172217349*^9}, {3.876563747494258*^9, 3.876563750114221*^9}, {
   3.876563789843149*^9, 3.876563795422017*^9}, {3.876564004566093*^9, 
   3.876564004592677*^9}, {3.876564191983989*^9, 3.876564192032833*^9}, {
   3.8765689766298*^9, 3.8765689766889277`*^9}, {3.876569170861136*^9, 
   3.876569170924027*^9}, {3.8765719199979486`*^9, 3.876571920233686*^9}, {
   3.876649373543977*^9, 3.8766493758441057`*^9}, {3.8769959839927807`*^9, 
   3.876995984061685*^9}, 3.877164404378254*^9, {3.8772732085232563`*^9, 
   3.877273222386714*^9}, {3.877273647416182*^9, 3.877273682479226*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b70aa1f2-c650-439c-acd6-8882249bf291"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Order 0 in \[Delta] \
==============================================================================\
=======================\"\>"], "Print",
 CellChangeTimes->{3.878713230522695*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"83020f8f-b945-454d-840c-62096f43cd1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"R", "[", "0", "]"}], "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x11", ",", "x12", ",", "x13"}], "}"}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"m", " ", "x11"}], "\[Omega]"]], " ", "m", " ", "0"}]}], 
        RowBox[{"3", " ", "m"}]]}]}], "]"}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{3.878713230853299*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"f3706fcc-6b56-4b57-a3d0-6238c276aa46"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.87871323086305*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"d855396f-e2ac-47d8-b606-fee7466574eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]], "Print",
 CellChangeTimes->{3.878713230927594*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"60d7f482-e86b-493f-95b5-7f8a5564f32e"],

Cell[BoxData["\<\"Order 1 in \[Delta] \
==============================================================================\
=======================\"\>"], "Print",
 CellChangeTimes->{3.878713230937846*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"ef693343-7d71-49d6-b381-fd811ff3a1d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"R", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x11", ",", "x12", ",", "x13"}], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"6", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x12", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "\[Omega]", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x13", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"4", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{"m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"6", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x12", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "m", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x13", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"m", " ", "x11"}], "\[Omega]"]], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["\[Omega]", "2"]}], ")"}], " ", "0"}]}], ")"}]}]}],
      "]"}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{3.878713237596423*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"bcd83fa3-36b1-4630-a395-300765464377"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8787132376059732`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"ab7da78c-31ee-4672-aff8-341f63ecebbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "\[Omega]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"\[Omega]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"2", " ", "\[Omega]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"3", " ", "\[Omega]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", "\[Omega]", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xl", "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"2", " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"2", " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"3", " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", "m", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xl", "+", "\[Alpha]"}], "]"}]}]}]], "Print",
 CellChangeTimes->{3.8787132378824387`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"7cc77904-e400-4ee0-8116-10165fc40b57"],

Cell[BoxData["\<\"Order 2 in \[Delta] \
==============================================================================\
=======================\"\>"], "Print",
 CellChangeTimes->{3.878713237889481*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"e0d4c457-0db6-4885-9dd2-80d932da5707"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"R", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x11", ",", "x12", ",", "x13"}], "}"}], ",", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"6", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "+", 
           SuperscriptBox["\[Omega]", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "m", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m", "2"], "-", 
            RowBox[{"5", " ", 
             SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"24", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"5", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"24", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"5", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{"10", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
         RowBox[{"40", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
         RowBox[{"6", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"12", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "+", "x12", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"7", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "+", "x12", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x12"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x12"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "+", "x13", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"7", " ", "m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x11", "+", "x13", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x13"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["\[Omega]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", "x13"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x12"}], "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"8", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x12", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "-", 
            RowBox[{"2", " ", "x13"}], "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"8", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"3", " ", "x11"}], "-", "x13", "-", "\[Alpha]"}], "]"}]}],
          "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
         RowBox[{"8", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
         RowBox[{"18", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x11"}], "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"14", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "+", "x12", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "+", "x12", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x12"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x12"}], "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"14", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "+", "x13", "+", "\[Alpha]"}], "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x11", "+", "x13", "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["m", "2"], " ", "\[Omega]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x13"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Omega]", "3"], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", "x13"}], "+", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          SuperscriptBox["\[ExponentialE]", 
           FractionBox[
            RowBox[{"m", " ", "x11"}], "\[Omega]"]], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["m", "4"], "+", 
            RowBox[{"5", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["\[Omega]", "2"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Omega]", "4"]}]}], ")"}], " ", "0"}]}], 
        ")"}]}]}], "]"}]}], "}"}], "}"}]], "Print",
 CellChangeTimes->{3.8787132444606543`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"5e513cc2-3a8d-4537-90d9-2f490637c368"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.8787132445091677`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"ead4c319-7b23-44e0-b402-5fdce7a0be87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"10", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"48", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "-", "xl", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"3", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"3", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"10", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
  RowBox[{"40", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"12", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"10", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "+", "xl", "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"14", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"xk", "+", "xl", "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["m", "4"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xl"}], "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["m", "2"], " ", 
   SuperscriptBox["\[Omega]", "2"], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"2", " ", "xl"}], "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"8", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "-", 
     RowBox[{"2", " ", "xl"}], "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"16", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"4", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"3", " ", "xk"}], "-", "xl", "-", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
  RowBox[{"8", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "-", 
  RowBox[{"18", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xk"}], "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"28", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "+", "xl", "+", "\[Alpha]"}], "]"}]}], "+", 
  RowBox[{"4", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xk", "+", "xl", "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"10", " ", 
   SuperscriptBox["m", "3"], " ", "\[Omega]", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xl"}], "+", "\[Alpha]"}], "]"}]}], "-", 
  RowBox[{"4", " ", "m", " ", 
   SuperscriptBox["\[Omega]", "3"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"2", " ", "xl"}], "+", "\[Alpha]"}], "]"}]}]}]], "Print",
 CellChangeTimes->{3.878713245746067*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"df6794d6-2cb3-4a23-b6d7-4ad64e8193e4"]
}, Open  ]]
}, Open  ]],

Cell[TextData[{
 "Next, we define the summands ",
 Cell[BoxData[
  FormBox[
   RowBox[{"ssin", "[", "1", "]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e228332a-dd49-4dc9-a07b-25079bde7851"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"scos", "[", "1", "]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fbb110dd-a8aa-4e57-b8e5-b279b6f90ba2"],
 " that appear in the solution formula of ",
 Cell[BoxData[
  RowBox[{" ", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["R", "k"], 
     RowBox[{"(", 
      RowBox[{"1", ",", "1"}], ")"}]], 
    RowBox[{"(", "\[CurlyPhi]", ")"}]}]}]],ExpressionUUID->
  "9844a1d6-c747-46b9-8d8a-22025a7e0ea6"],
 " when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", "\[Phi]", ")"}], "=", 
    RowBox[{"sin", "(", "n\[Phi]", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5efefa66-039e-4ec1-bdad-a8f5aed71982"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "(", "\[CurlyPhi]", ")"}], " ", "=", " ", 
    RowBox[{"cos", "(", "n\[CurlyPhi]", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d44b8573-15df-428d-ad1c-987230eb7fd3"],
 ". The validity of these functions can be checked with the code above. When \
you do that, remember to adjust the fct[1] to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "*", "Num", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", "^", "2"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", "n\[Omega]", ")"}], "^", "2"}]}], ")"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0742a08b-d3a6-496d-897b-5542938ded65"],
 ". They are only relevant for supplementary calculations in the appendix in \
the paper."
}], "Text",
 CellChangeTimes->{{3.8772743545407867`*^9, 3.8772746285235367`*^9}, {
  3.877275015809505*^9, 
  3.877275035489283*^9}},ExpressionUUID->"2b469c5c-93ac-4aa0-8fc7-\
df4f1e450e8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"gensols", " ", "def"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ssin", "[", "1", "]"}], "[", 
      RowBox[{"xk_", ",", "xl_"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"n", " ", "\[Omega]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], " ", "-", 
         " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"xk", " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "xl"}], " ", "-", " ", 
           "\[Alpha]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "3"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}], "xk"}], " ", "-", " ", "xl", 
            " ", "-", " ", "\[Alpha]"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"xk", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "xl"}], " ", "-", " ", 
           "\[Alpha]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], " ", "+", " ", "\[Alpha]"}], "]"}]}], 
         " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "xk"}], "+", "xl", "+", 
            "\[Alpha]"}], "]"}]}]}], ")"}]}], " ", "+", 
      RowBox[{"m", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"xk", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "xl"}], " ", "-", " ", 
           "\[Alpha]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "3"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}], "xk"}], "-", "xl", "-", 
            "\[Alpha]"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"xk", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "xl"}], "-", "\[Alpha]"}], "]"}],
          " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], " ", "+", " ", "\[Alpha]"}], "]"}]}], 
         " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "xk"}], " ", "+", " ", "xl", 
            " ", "+", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"scos", "[", "1", "]"}], "[", 
      RowBox[{"xk_", ",", "xl_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"n", " ", "\[Omega]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}]}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], "-", "\[Alpha]"}], "]"}]}], " ", "-", 
         " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"xk", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "xl"}], "-", "\[Alpha]"}], "]"}],
          " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "3"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}], "xk"}], " ", "-", " ", "xl", 
            " ", "-", " ", "\[Alpha]"}], "]"}]}], " ", "+", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"xk", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "xl"}], "-", "\[Alpha]"}], "]"}],
          " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], " ", "+", " ", "\[Alpha]"}], "]"}]}], 
         " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "xk"}], " ", "+", " ", "xl", 
            " ", "+", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}], " ", "+", " ", 
      RowBox[{"m", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], " ", "-", " ", "\[Alpha]"}], "]"}]}], 
         " ", "-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"xk", " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "xl"}], " ", "-", " ", 
           "\[Alpha]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "3"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}], "xk"}], " ", "-", " ", "xl", 
            " ", "-", " ", "\[Alpha]"}], "]"}]}], " ", "-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"xk", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "xl"}], " ", "-", " ", 
           "\[Alpha]"}], "]"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"n", " ", "xk"}], " ", "+", " ", "\[Alpha]"}], "]"}]}], 
         " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "xk"}], " ", "+", " ", "xl", 
            " ", "+", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8765726130398617`*^9, 3.8765729460477867`*^9}, {
  3.876573370856092*^9, 3.876573575293713*^9}, {3.8766493943390017`*^9, 
  3.876649398340529*^9}, {3.876655963851881*^9, 3.876655963955131*^9}, {
  3.87727514147381*^9, 3.877275143118691*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"d5c12862-3d8a-49c5-8200-50e443d07110"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Reductions", "Section",
 CellChangeTimes->{{3.877446919949839*^9, 
  3.87744692302975*^9}},ExpressionUUID->"8f6f50c8-1ffb-4f81-b067-\
06f13de465e2"],

Cell[TextData[{
 "Given the solutions of these PDEs, we can now assemble the right-hand sides \
of phase reduced systems. On first order in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["K", "TI"], TraditionalForm], "errors" -> {}, "input" -> "K", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "612529a8-7c9f-4957-b436-de83ec45f39c"],
 " most expressions are short, so they can directly be implemented in Matlab. \
However, on second order, formulas get too long, so we calculate an \
expression for the formula here in Mathematica and convert the result to a \
Matlab code. We use a \[OpenCurlyDoubleQuote]Mathematica Expression to Matlab \
m-file Converter\[CloseCurlyDoubleQuote] \
https://library.wolfram.com/infocenter/MathSource/577/ (November 29, 2022) to \
convert the Mathematica Code to Matlab. The resulting strings can then be \
copied directly into Matlab. Use the above link to download the files and put \
them in the same path as this Mathematica notebook. The following Cell then \
includes the files."
}], "Text",
 CellChangeTimes->{{3.877446934538756*^9, 3.877446946589829*^9}, {
  3.87744723066076*^9, 3.877447241395702*^9}, {3.878705788230115*^9, 
  3.8787058773736973`*^9}, {3.878706205902257*^9, 
  3.8787062140679893`*^9}},ExpressionUUID->"38a26139-86cf-4d13-9d6a-\
ce9ea0623044"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", " ", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ToMatlab.m"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"0fa86862-6971-4e16-9331-f8f82a24bc5f"],

Cell[CellGroupData[{

Cell["Straight-Forward evaluation for few oscillators", "Subsection",
 CellChangeTimes->{{3.878705483207747*^9, 
  3.878705493143383*^9}},ExpressionUUID->"9361b0a9-cade-4abe-b725-\
bf8a84269af9"],

Cell[TextData[{
 "If the number of oscillators is small, a straight-forward approach is best.\
\nThe result of the following cell was used in the Matlab file ",
 Cell[BoxData[
  RowBox[{"rhs_K2d1", 
   RowBox[{"_slow", ".", "m"}]}]], "InlineCode",ExpressionUUID->
  "49faf431-de88-4d5b-8a4a-b5ca7bec5ed1"],
 " and in ",
 Cell[BoxData[
  RowBox[{"rhs_K2d2", 
   RowBox[{"_slow", ".", "m"}]}]], "InlineCode",ExpressionUUID->
  "aebdf612-b000-4522-bf0d-a7311118f263"]
}], "Text",
 CellChangeTimes->{{3.8787055047271767`*^9, 3.878705538327016*^9}, {
  3.878706069732551*^9, 3.878706140141321*^9}, {3.87870619114839*^9, 
  3.878706191492106*^9}},ExpressionUUID->"ade9f6b4-7fb2-43ae-b72c-\
8aa04fcf356e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], "[", 
     RowBox[{"xk", ",", "xl"}], "]"}], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
      RowBox[{"xl", "->", " ", 
       RowBox[{"transpose", "[", "ph", "]"}]}], ",", " ", 
      RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
      RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", "ex", "]"}]}], "Input",
 CellChangeTimes->{{3.873288155928987*^9, 3.8732881739967203`*^9}, {
  3.8732882089574738`*^9, 3.873288222756895*^9}, {3.873288257942646*^9, 
  3.8732882682116203`*^9}, {3.873289038867991*^9, 3.873289108126237*^9}, {
  3.8732892030473843`*^9, 3.873289229789716*^9}, {3.873289270543727*^9, 
  3.873289308965281*^9}, {3.873861259393983*^9, 3.873861260368499*^9}, {
  3.874125324626938*^9, 3.874125398224618*^9}, {3.8741255234211073`*^9, 
  3.874125523487211*^9}, {3.878706037925935*^9, 3.878706038092906*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"087cc9a8-8cf5-4220-b4c7-603798a455f3"],

Cell[TextData[{
 "The result of the following cell was used in the Matlab file ",
 Cell[BoxData[
  RowBox[{"rhs_K2d2", 
   RowBox[{"_slow", ".", "m"}]}]], "InlineCode",ExpressionUUID->
  "c19fe8cc-7f4b-4a9b-9b29-1e75ccebfb25"]
}], "Text",
 CellChangeTimes->{{3.8787061494683533`*^9, 
  3.878706173093252*^9}},ExpressionUUID->"f8ef5d93-b359-4934-8d6b-\
0ad29cb0169e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"s", "[", "2", "]"}], "[", 
     RowBox[{"xk", ",", "xl"}], "]"}], "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
      RowBox[{"xl", "->", " ", 
       RowBox[{"transpose", "[", "ph", "]"}]}], ",", " ", 
      RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
      RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", "ex", "]"}]}], "Input",
 CellChangeTimes->{3.878706187566925*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"35774516-7213-43d2-bcb5-95becd214c63"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fast Evaluation for a large number of oscillators", "Subsection",
 CellChangeTimes->{{3.878705370466206*^9, 
  3.878705380327816*^9}},ExpressionUUID->"5d585a70-c862-48e6-a7b2-\
6108773e31de"],

Cell["\<\
If the number of oscillators is large, we recommend using the order parameter \
to increase the performance of the code.\
\>", "Text",
 CellChangeTimes->{{3.878704573828561*^9, 3.878704699813957*^9}, {
  3.878704773390242*^9, 3.8787048067024527`*^9}, {3.878705391088111*^9, 
  3.87870547562361*^9}, {3.8787064185469646`*^9, 
  3.878706422660481*^9}},ExpressionUUID->"61fb6d99-b7d3-4b3d-afda-\
fa1171b3f066"],

Cell[CellGroupData[{

Cell[TextData[{
 "Terms of order ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox["\[Delta]", "0"], TraditionalForm], "errors" -> {}, 
     "input" -> "\\delta^0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ba6cd5c2-31dc-4b4a-ad66-44d6b2db5c01"]
}], "Subsubsection",
 CellChangeTimes->{{3.8787070930475283`*^9, 
  3.878707102971713*^9}},ExpressionUUID->"b3c363b1-2bd2-4361-9f88-\
a76ac5845b86"],

Cell[TextData[{
 "The following cell calculates an expression for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}], "\[LongEqual]", 
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "0"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SubsuperscriptBox[
          StyleBox["R", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "P_k^{(2,0)}(\\phi) = \\nabla_R H_k^{(-,0)}(1,\\phi) \\cdot R^{(1,0)}_k(\
\\phi)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "781c8eac-dfc5-4930-98e3-15810013f44b"],
 ". This was used in the Matlab file ",
 Cell[BoxData[
  RowBox[{"rhs_K2d0", ".", "m"}]], "InlineCode",ExpressionUUID->
  "76831eca-2c13-47f0-b12f-70ef914e1905"]
}], "Text",
 CellChangeTimes->{{3.878706463442396*^9, 
  3.8787065651225557`*^9}},ExpressionUUID->"863cdb4d-e516-48b8-83e3-\
a2cd5f6cc3fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.878706435643981*^9, 3.8787064377711687`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"0e076688-be1c-4ab3-9c9c-e893b7c5f1a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "First order in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "689cf60f-5dba-4319-b248-0ed3124336a1"]
}], "Subsubsection",
 CellChangeTimes->{{3.878707077455927*^9, 
  3.8787070818428383`*^9}},ExpressionUUID->"b0895d4a-2054-48a1-8896-\
306feb2aa157"],

Cell[TextData[{
 "Next, we calculate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"2", ",", "1"}], ")"}]], "(", "\[Phi]", ")"}], 
       TraditionalForm], "errors" -> {}, "input" -> "P_k^{(2,1)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "177b1f08-886f-4d2f-bec9-f3d6f7ab3f2d"],
 ", which consists of two parts. The following cell calculates an expression \
for the first part ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "0"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla_R H_k^{(-,0)}(1,\\phi) \\cdot R^{(1,1)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4a16ef9c-a775-4731-8ba7-f63f7a2c8710"]
}], "Text",
 CellChangeTimes->{{3.878704573828561*^9, 3.878704699813957*^9}, {
   3.878704773390242*^9, 3.8787048067024527`*^9}, {3.878705391088111*^9, 
   3.87870547562361*^9}, 3.8787064185469646`*^9, {3.878706726606689*^9, 
   3.878706780792645*^9}},ExpressionUUID->"ca2d2364-800e-4bea-b21c-\
a450916e968b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8741376244192057`*^9, 3.874137629770492*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"f1019009-c8a0-495d-a6c1-db0bb057fab6"],

Cell[TextData[{
 "The next cell calculates the second part, which is ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "1"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla_R H_k^{(-,1)}(1,\\phi) \\cdot R^{(1,0)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "adc57fba-e271-4576-853c-77ca255d2281"],
 ". These two parts are used in the Matlab file ",
 Cell[BoxData[
  RowBox[{"rhs_K2d1", ".", "m"}]], "InlineCode",ExpressionUUID->
  "f2dc8924-fdd0-4698-8bf8-740d13d23581"]
}], "Text",
 CellChangeTimes->{{3.87870681150448*^9, 
  3.87870687231382*^9}},ExpressionUUID->"638a2ef7-c74c-430a-9b91-\
63a6dc345c58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"4", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "xl", "]"}], " ", "-", " ", 
       RowBox[{"Sin", "[", "xk", "]"}]}], ")"}], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.878706989064398*^9, 3.878707005852243*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7244a9d2-cc98-4b13-93a0-f53d7c057673"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Second order in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f697172b-5f98-4769-80a1-60d866c6fb0e"]
}], "Subsubsection",
 CellChangeTimes->{{3.8787070563313627`*^9, 
  3.878707065878579*^9}},ExpressionUUID->"a52f0fbb-27bc-45b8-943c-\
f63663761714"],

Cell[TextData[{
 "Next, we calculate an expression ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["P", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"2", ",", "2"}], ")"}]], "(", "\[Phi]", ")"}], 
       TraditionalForm], "errors" -> {}, "input" -> "P_k^{(2,2)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "36e68b07-456d-4b63-9747-b128135ddc33"],
 ", which consists of three parts. All three parts are used in the Matlab \
file ",
 Cell[BoxData[
  RowBox[{"rhs_K2d2", ".", "m"}]], "InlineCode",ExpressionUUID->
  "d6e5cc67-a76a-42be-9cdb-dba75281a3a1"],
 ". The first part is given by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "0"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "2"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla_R H_k^{(-,0)}(1,\\phi) \\cdot R^{(1,2)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7520b014-0386-4e17-9ae7-ca75cf64158a"],
 ", which is calculated in the following cell"
}], "Text",
 CellChangeTimes->{{3.878704709915843*^9, 3.878704717723422*^9}, 
   3.8787048312435827`*^9, {3.8787068901205187`*^9, 
   3.878706956975791*^9}},ExpressionUUID->"b5f2f1c7-61b9-431f-8d0f-\
8913015e2b83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "2", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8732721308038883`*^9, 3.87327213428975*^9}, {
  3.874138318159442*^9, 3.8741383216503*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"1d84c776-8549-4dc0-a386-0b9fe9740b29"],

Cell[TextData[{
 "Next, we calculate an expression for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "1"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla_R H_k^{(-,1)}(1,\\phi) \\cdot R^{(1,1)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "1ef888c4-ad68-48e4-8450-402d71072845"]
}], "Text",
 CellChangeTimes->{
  3.878704864287023*^9},ExpressionUUID->"59752014-f2be-468e-a1e3-\
eade3b4dd51b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"4", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "xl", "]"}], " ", "-", " ", 
       RowBox[{"Sin", "[", "xk", "]"}]}], ")"}], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "1", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873273646249227*^9, 3.8732737864377117`*^9}, {
  3.87329338987401*^9, 3.873293486296883*^9}, {3.874137869762253*^9, 
  3.87413787512949*^9}, {3.874138468568273*^9, 3.874138470685326*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"9bad1a4f-b350-454c-ac87-225fcc2ef0da"],

Cell[TextData[{
 "Finally, we calculate an expression for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         SubsuperscriptBox[
          StyleBox["H", "TI"], 
          StyleBox["k", "TI"], 
          RowBox[{"(", 
            RowBox[{"-", ",", "2"}], ")"}]], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}], "\[CenterDot]", 
         SuperscriptBox[
          StyleBox["R", "TI"], 
          RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}]], 
         RowBox[{"(", "\[Phi]", ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "\\nabla_R H_k^{(-,2)}(1,\\phi)\\cdot R^{(1,0)}(\\phi)", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "35339286-2a1c-4f51-b5f2-faa5c88289e9"]
}], "Text",
 CellChangeTimes->{{3.878704922805743*^9, 3.878704969709016*^9}, {
  3.87870500432891*^9, 3.8787050103837633`*^9}, {3.8787051936184464`*^9, 
  3.8787052225480537`*^9}, {3.878706967664001*^9, 
  3.878706968464287*^9}},ExpressionUUID->"01da16c4-cb19-47dc-b3fe-\
f7081fcb72c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", " ", "=", " ", 
   RowBox[{
    RowBox[{"8", "*", 
     RowBox[{"Sin", "[", "xk", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sin", "[", "xk", "]"}], "-", 
       RowBox[{"Sin", "[", "xl", "]"}]}], ")"}], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"s", "[", "0", "]"}], "[", 
        RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
    "TrigReduce"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex1", " ", "=", " ", 
   RowBox[{"ex", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xi"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xi"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ex2", " ", "=", " ", 
   RowBox[{"ex1", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Cos", ",", " ", "xl"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "x_", "]"}], " ", ":>", " ", 
       RowBox[{"OrderParamRepRule", "[", 
        RowBox[{"x", ",", " ", "Sin", ",", " ", "xl"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ex2", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xk", "->", " ", "ph"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", " ", "alpha"}], ",", " ", 
     RowBox[{"\[Omega]", "->", " ", "omega"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873274764615958*^9, 3.873274768726975*^9}, {
  3.8732748506557827`*^9, 3.873274913614119*^9}, {3.8741385804706507`*^9, 
  3.874138583028318*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"293cefdc-eafb-4f6a-bc26-73a26074364c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.877275151608539*^9, 
  3.8772751814884253`*^9}},ExpressionUUID->"5cf7ad3f-27cd-41fb-8524-\
41f5a5e2ca4b"],

Cell[TextData[{
 "To investigate Floquet exponents in phase reduced systems, we need to \
define phase reduced systems. The following cell defines the function ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["H", "TI"], "(", 
         RowBox[{"1", ",", "\[Phi]"}], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "H(1,\\phi)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "cd1e2138-b911-46a2-a34f-ec950d075c1d"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Del]", 
          StyleBox["R", "TI"]], 
         StyleBox["H", "TI"], 
         RowBox[{"(", 
           RowBox[{"1", ",", "\[Phi]"}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\nabla_R H(1,\\phi)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "87e6047b-8aa3-4b92-b10f-e7204be4e63f"],
 ", which is required for phase reductions of order 1 and 2 in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["K", "TI"], TraditionalForm], "errors" -> {}, "input" -> "K", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e34fe505-c9ad-47db-ab88-82c982ae5be9"],
 "."
}], "Text",
 CellChangeTimes->{{3.87744468156164*^9, 3.877444710369965*^9}, {
  3.87744485142731*^9, 
  3.877444866554422*^9}},ExpressionUUID->"f299dace-3ed4-47b2-8fb2-\
d63baeacad3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H", "  ", "=", " ", 
    RowBox[{
     RowBox[{"1", "/", "Num"}], "*", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]", " ", 
               RowBox[{"g", "[", 
                RowBox[{"\[Phi]", "[", "ll", "]"}], "]"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]", " ", 
               RowBox[{"g", "[", 
                RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}]}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "ll", "]"}], "-", 
             RowBox[{"\[Phi]", "[", "kk", "]"}], "+", "\[Alpha]"}], "]"}]}], 
          "-", 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ll", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ";"}], " ", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"radii", " ", "are", " ", "fixed", " ", "to", " ", "1"}], ",", 
    " ", 
    RowBox[{
    "but", " ", "phases", " ", "are", " ", "still", " ", "free", " ", 
     "arguments"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradH", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "Num"}], "*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]", " ", 
           RowBox[{"g", "[", 
            RowBox[{"\[Phi]", "[", "ll", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]", " ", 
           RowBox[{"g", "[", 
            RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}]}], "*", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "ll", "]"}], "-", 
         RowBox[{"\[Phi]", "[", "kk", "]"}], "+", "\[Alpha]"}], "]"}]}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", "Num"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ll", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradH", " ", "=", " ", 
   RowBox[{"gradH", "-", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Diagonal", "[", "gradH", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradH", " ", "=", " ", 
   RowBox[{"gradH", " ", "-", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Total", "[", 
      RowBox[{"gradH", ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.874660597448361*^9, 3.8746605981823997`*^9}, {
   3.874669145767975*^9, 3.874669163504346*^9}, {3.874669198517313*^9, 
   3.874669241645653*^9}, {3.874669295629079*^9, 3.874669367235083*^9}, {
   3.874669398904525*^9, 3.874669433516028*^9}, {3.874669487773542*^9, 
   3.8746695538826103`*^9}, 3.8746696008460407`*^9, {3.874669666848221*^9, 
   3.874669676074853*^9}, {3.8746702169759398`*^9, 3.8746703309605*^9}, {
   3.87473319064649*^9, 3.8747331915705833`*^9}, {3.87744481278804*^9, 
   3.877444830891099*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e8a5c974-383d-4622-8791-e81b1ef36e1b"],

Cell[TextData[{
 "Next, we define the different parts of a phase reduction. If you want to \
study a phase reduction with orders up to two in both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Delta]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\delta", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3bd8378c-bf80-4002-9102-5928a5356e56"],
 " and K, run the following cell."
}], "Text",
 CellChangeTimes->{{3.8774449529686947`*^9, 3.877444986144637*^9}, {
  3.877445458357912*^9, 
  3.877445489341935*^9}},ExpressionUUID->"5493c18c-70e0-4388-9a43-\
2d4786977281"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PK1dall", " ", "=", " ", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"H", " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Delta]", ",", " ", "0", ",", "2"}], "}"}]}], "]"}], " ", "//",
     "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK1d0", " ", "=", " ", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"H", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", " ", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK1d1", " ", "=", " ", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"H", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", " ", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK1d2", " ", "=", " ", 
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{"H", ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", " ", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK2d0", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gradH", "[", 
           RowBox[{"[", 
            RowBox[{"kk", ",", "ll"}], "]"}], "]"}], "/.", " ", 
          RowBox[{"\[Delta]", "->", " ", "0"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "0", "]"}], "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "ll", "]"}], ",", 
           RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
         RowBox[{"fct", "[", "0", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ll", ",", "1", ",", "Num"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK2d1", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{
           RowBox[{"gradH", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "ll"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Delta]", ",", "1", ",", "1"}], "}"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "0", "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "ll", "]"}], ",", 
            RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
          RowBox[{"fct", "[", "0", "]"}]}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gradH", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "ll"}], "]"}], "]"}], "/.", " ", 
           RowBox[{"\[Delta]", "->", " ", "0"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "ll", "]"}], ",", 
            RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
          RowBox[{"fct", "[", "1", "]"}]}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ll", ",", "1", ",", "Num"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PK2d2", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{
           RowBox[{"gradH", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "ll"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Delta]", ",", "0", ",", "0"}], "}"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "2", "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "ll", "]"}], ",", " ", 
            RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
          RowBox[{"fct", "[", "2", "]"}]}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{
           RowBox[{"gradH", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "ll"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Delta]", ",", "1", ",", "1"}], "}"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "1", "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "ll", "]"}], ",", " ", 
            RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
          RowBox[{"fct", "[", "1", "]"}]}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"SeriesCoefficient", "[", 
          RowBox[{
           RowBox[{"gradH", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "ll"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Delta]", ",", "2", ",", "2"}], "}"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "0", "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "ll", "]"}], ",", 
            RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
          RowBox[{"fct", "[", "0", "]"}]}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ll", ",", "1", ",", "Num"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhs", " ", "=", " ", 
    RowBox[{"\[Omega]", " ", "+", " ", 
     RowBox[{"K", "*", "PK1d0"}], " ", "+", " ", 
     RowBox[{"K", "*", "\[Delta]", " ", "*", " ", "PK1d1"}], " ", "+", " ", 
     RowBox[{"K", "*", 
      RowBox[{"\[Delta]", "^", "2"}], "*", "PK1d2"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"K", "^", "2"}], "*", "PK2d0"}], "+", " ", 
     RowBox[{
      RowBox[{"K", "^", "2"}], "*", "\[Delta]", "*", "PK2d1"}], "+", 
     RowBox[{
      RowBox[{"K", "^", "2"}], "*", 
      RowBox[{"\[Delta]", "^", "2"}], "  ", "*", " ", "PK2d2"}]}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "rhs", " ", "can", " ", "be", " ", "adjusted", " ", "to", " ",
     "contain", " ", "different", " ", "orders", " ", "of", " ", "delta", " ",
     "and", " ", "K"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.877445011836342*^9, 3.8774451604720984`*^9}, {
  3.877445197633875*^9, 3.8774452570697927`*^9}, {3.8774452926092453`*^9, 
  3.8774454254543123`*^9}, {3.8774454920305233`*^9, 3.8774454988662453`*^9}, {
  3.877446252735186*^9, 3.877446296666175*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"b63489f6-e411-4a62-be34-9c7f5c8f1f67"],

Cell[TextData[{
 "Alternatively, if you want to consider a ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"(", 
         RowBox[{"1", ",", "\[Infinity]"}], ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "(1,\\infty)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "20c0a1d4-dd65-4b71-b937-e6b6bd1b02f8"],
 "-phase reduction, use the following right-hand side:"
}], "Text",
 CellChangeTimes->{{3.877445505773138*^9, 
  3.877445546989306*^9}},ExpressionUUID->"fc5bd3a6-80b5-4bb4-9ba8-\
9922b432c7a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhs", " ", "=", " ", 
   RowBox[{"\[Omega]", " ", "+", " ", 
    RowBox[{"K", "*", "H"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877445011836342*^9, 3.8774451604720984`*^9}, {
   3.877445197633875*^9, 3.8774452570697927`*^9}, {3.8774452926092453`*^9, 
   3.8774454254543123`*^9}, {3.8774454920305233`*^9, 
   3.8774454988662453`*^9}, {3.877445549975061*^9, 3.877445554190729*^9}, 
   3.877446230641766*^9},ExpressionUUID->"834371c4-f0a7-40b3-bc6f-\
ace05ce8e603"],

Cell["\<\
Moreover, since we want to compare phase reductions to the full system, we \
introduce the full system next:\
\>", "Text",
 CellChangeTimes->{{3.8787107324830313`*^9, 
  3.878710752578663*^9}},ExpressionUUID->"8ee2416c-4708-44c6-8ccb-\
22350ed6988b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uniquelistRad", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Unique", "[", "\"\<Rad\>\"", "]"}], ",", " ", 
     RowBox[{"{", "Num", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", " ", 
    RowBox[{"i", "<=", " ", "Num"}], ",", " ", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", "i", "]"}], "=", " ", 
      RowBox[{"uniquelistRad", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rads", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{"R", ",", " ", "Num"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullRHS", "=", " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"m", "*", 
        RowBox[{
         RowBox[{"R", "[", "kk", "]"}], "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R", "[", "kk", "]"}], "-", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]", " ", 
           RowBox[{"g", "[", 
            RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}]}], " ", "+", 
       " ", 
       RowBox[{"K", "*", " ", 
        RowBox[{"1", "/", "Num"}], "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "ll", "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "ll", "]"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}]}], 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "ll", "]"}], "-", 
              RowBox[{"\[Phi]", "[", "kk", "]"}], "+", "\[Alpha]"}], "]"}]}], 
           "-", 
           RowBox[{
            RowBox[{"R", "[", "kk", "]"}], 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], " ", "-", " ", 
           RowBox[{"\[Delta]", " ", 
            RowBox[{
             RowBox[{"g", "'"}], "[", 
             RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"R", "[", "ll", "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"c", "+", 
                  RowBox[{"\[Delta]", " ", 
                   RowBox[{"g", "[", 
                    RowBox[{"\[Phi]", "[", "ll", "]"}], "]"}]}]}], ")"}], "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"c", "+", 
                   RowBox[{"\[Delta]", " ", 
                    RowBox[{"g", "[", 
                    RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}], "^",
                  "2"}]}], 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"\[Phi]", "[", "ll", "]"}], "-", 
                 RowBox[{"\[Phi]", "[", "kk", "]"}], "+", "\[Alpha]"}], 
                "]"}]}], "-", " ", 
              RowBox[{
               RowBox[{"R", "[", "kk", "]"}], 
               RowBox[{
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"\[Delta]", " ", 
                   RowBox[{"g", "[", 
                    RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], 
                 ")"}]}]}]}], ")"}]}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}], "~", "Join", "~", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "+", " ", 
       RowBox[{
        RowBox[{"K", "/", "Num"}], " ", "*", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"R", "[", "ll", "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]", " ", 
                RowBox[{"g", "[", 
                 RowBox[{"\[Phi]", "[", "ll", "]"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"R", "[", "kk", "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"\[Delta]", " ", 
                  RowBox[{"g", "[", 
                   RowBox[{"\[Phi]", "[", "kk", "]"}], "]"}]}]}], ")"}]}], 
              ")"}]}], 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "ll", "]"}], "-", 
              RowBox[{"\[Phi]", "[", "kk", "]"}], "+", "\[Alpha]"}], "]"}]}], 
           "-", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"ll", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"965e2e08-3cf7-4135-b5bd-f839b85f111f"],

Cell[CellGroupData[{

Cell["Synchronized Orbit", "Subsection",
 CellChangeTimes->{{3.877275190197665*^9, 
  3.87727519549611*^9}},ExpressionUUID->"d70dbfd9-85a4-43c5-b843-\
8ccef8a5e53b"],

Cell[TextData[{
 "To study Floquet exponents of a synchronized orbit in phase reduced \
systems, we linearize the the right-hand side ",
 Cell[BoxData[
 "rhs"], "InlineCode",ExpressionUUID->
  "8c8b8607-ec85-48c9-9248-0917d2754781"],
 " at a synchronized state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9f3efba7-a49c-452f-912e-14a96baabe1d"],
 " to obtain a Jacobian matrix. Due commutative property of these matrices \
(for different values of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Gamma]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\gamma", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "23e53328-2661-48f6-936a-d9c80d6665b5"],
 "), we can then integrate it over one period of the orbit."
}], "Text",
 CellChangeTimes->{{3.877446027442808*^9, 
  3.877446206745913*^9}},ExpressionUUID->"c8b9daf9-ca03-496d-9650-\
53345fd599bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jacobi", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"rhs", ",", " ", 
       RowBox[{"{", "phis", "}"}]}], "]"}], " ", "/.", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "i", "]"}], "->", " ", "\[Gamma]"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], " ", "//", " ",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poincare", " ", "=", " ", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{"Jacobi", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Gamma]", ",", " ", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", "\[Omega]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"floq", " ", "=", " ", 
  RowBox[{"Eigenvalues", "[", "poincare", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"contains", " ", "one", " ", "1", " ", "eigenvalue"}], ",", " ", 
    RowBox[{"that", " ", "has", " ", "to", " ", "be", " ", "ignored"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.87744633517801*^9, 3.877446367128071*^9}, {
  3.878710170968676*^9, 3.878710171903792*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"24d340e0-aeb4-4959-8b6e-959743b1faf1"],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Delta]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\delta = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "dd539b21-09ef-4758-bd4a-06135debdab5"],
 ", we can change into a rotating coordinate frame, in which each \
synchronized state is an equilibrium. Then we linearize around a synchronized \
state in the full system. The resulting Jacobian matrix is denoted by ",
 Cell[BoxData[
 "Jacobifull"], "InlineCode",ExpressionUUID->
  "595234a6-66dd-4829-9f71-31a97fc173d7"],
 " or ",
 Cell[BoxData[
 "Jacobifull2"], "InlineCode",ExpressionUUID->
  "3d095e01-ae2c-422f-8e36-e9bb29c88172"],
 " (results should agree). Then, we determine the eigenvalues of this matrix. \
These are used to infer Floquet exponents, as described in the Paper."
}], "Text",
 CellChangeTimes->{{3.8774440944775257`*^9, 3.877444215996497*^9}, {
  3.8774442777081614`*^9, 3.877444303588166*^9}, {3.878711061587797*^9, 
  3.878711088696776*^9}},ExpressionUUID->"d3de88e0-240e-43bb-ba14-\
3c9e97c61a1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Jacobifull", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"FullRHS", "/.", " ", 
         RowBox[{"\[Delta]", "->", " ", "0"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Rads", "/.", " ", 
            RowBox[{"List", "->", " ", "Sequence"}]}], ",", " ", 
           RowBox[{"phis", "/.", " ", 
            RowBox[{"List", "->", " ", "Sequence"}]}]}], "}"}], "}"}]}], 
       "]"}], " ", "/.", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "[", "kk", "]"}], "->", " ", "1"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], " ", "/.", 
     " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "kk", "]"}], "->", " ", "\[Gamma]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], ";"}], "\n",
   " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"mat", " ", "=", " ", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Num", ",", " ", "Num"}], "}"}]}], "]"}], "-", " ", 
      RowBox[{"Num", "*", 
       RowBox[{"IdentityMatrix", "[", "Num", "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Jacobifull2", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"m", " ", "*", " ", 
            RowBox[{"IdentityMatrix", "[", "Num", "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"K", "/", "Num"}], " ", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", "mat"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "K"}], "/", "Num"}], " ", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}], "mat"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"K", "/", "Num"}], " ", 
           RowBox[{"Sin", "[", "\[Alpha]", "]"}], "mat"}], ",", " ", 
          RowBox[{
           RowBox[{"K", "/", "Num"}], " ", 
           RowBox[{"Cos", "[", "\[Alpha]", "]"}], "mat"}]}], "}"}]}], "}"}], 
      " ", "//", " ", "ArrayFlatten"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jacobifull", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ev", " ", "=", " ", 
   RowBox[{"Eigenvalues", "[", "Jacobifull", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "ev"}], "Input",
 CellChangeTimes->{{3.8787109083370247`*^9, 3.878710909450994*^9}, {
  3.878710988756071*^9, 3.8787110512425737`*^9}, {3.878711103169465*^9, 
  3.878711110769384*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"5ed6614b-2b7a-41e6-901f-0533f935e2d4"],

Cell[TextData[{
 "Next, we study the effect of higher-harmonics in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["g", "TI"], "(", "\[Phi]", ")"}], TraditionalForm], 
     "errors" -> {}, "input" -> "g(\\phi)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "77ece2ab-2433-424f-ac27-a0605f97ae9d"],
 " on the Floquet exponent of the synchronized orbit in a (2,1)-phase \
reduction. If the result of the following cell is 0, it is confirmed that \
Floquet exponents do not depend on higher-harmonics in a (2,1)-phase \
reduction."
}], "Text",
 CellChangeTimes->{{3.8774474893146467`*^9, 3.877447515738954*^9}, {
  3.87744759554626*^9, 3.877447686841833*^9}, {3.878710444372613*^9, 
  3.8787104749563704`*^9}},ExpressionUUID->"31a3f5bc-f845-4b0f-b7e2-\
8f1f0a029798"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PK2d1gen", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gradH", "[", 
           RowBox[{"[", 
            RowBox[{"kk", ",", "ll"}], "]"}], "]"}], " ", "/.", " ", 
          RowBox[{"\[Delta]", "->", " ", "0"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"scos", "[", "1", "]"}], "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "ll", "]"}], ",", " ", 
           RowBox[{"\[Phi]", "[", "ii", "]"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "Num", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", "^", "2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", " ", "\[Omega]"}], ")"}], "^", "2"}]}], ")"}]}], 
          ")"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ll", ",", "1", ",", "Num"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "1", ",", "Num"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jacobigen", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"PK2d1gen", ",", " ", 
       RowBox[{"{", "phis", "}"}]}], "]"}], "/.", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "i", "]"}], "->", " ", "\[Xi]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], " ", "//", " ",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Jacobigen", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", " ", "=", " ", 
   RowBox[{
    RowBox[{"Jacobigen", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "*", " ", "Num"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Jacobigen", " ", "-", " ", 
    RowBox[{"fun", " ", "*", " ", 
     RowBox[{"1", "/", "Num"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Num", ",", " ", "Num"}], "}"}]}], "]"}], "-", 
       RowBox[{"Num", "*", 
        RowBox[{"IdentityMatrix", "[", "Num", "]"}]}]}], ")"}]}]}], " ", "//",
    "Simplify"}], "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", "fun", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"Element", "[", 
     RowBox[{"n", ",", " ", "Integers"}], "]"}], ",", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{"fun", " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Xi]", ",", " ", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.877447519116763*^9, 3.87744752512458*^9}, {
  3.877447564675878*^9, 3.877447584355441*^9}, {3.878710309385728*^9, 
  3.878710311166327*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"55d0805b-2598-495d-aa43-af5e385d1bc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Splay Orbit", "Subsection",
 CellChangeTimes->{{3.8774464136093397`*^9, 
  3.877446415768173*^9}},ExpressionUUID->"8a1a7cee-fa57-4ef2-a958-\
20bb88734c58"],

Cell[TextData[{
 "First, we consider the splay orbit in phase reduced systems, when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Delta]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\delta = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "29b41686-4c22-4979-a5a4-e50cacd3fe6b"],
 "."
}], "Text",
 CellChangeTimes->{{3.878711424647214*^9, 3.878711438759479*^9}, {
  3.878711505303042*^9, 
  3.87871151274275*^9}},ExpressionUUID->"d940d9dc-2eb5-4ad5-8867-\
c7e5d25d2005"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jacobisplay", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"rhs", ",", " ", 
        RowBox[{"{", "phis", "}"}]}], "]"}], " ", "/.", " ", 
      RowBox[{"\[Delta]", "->", " ", "0"}]}], "/.", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "i", "]"}], "->", " ", 
        RowBox[{"\[Xi]", " ", "+", " ", 
         RowBox[{"2", "\[Pi]", " ", 
          RowBox[{"i", " ", "/", "Num"}]}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], " ", "//", " ",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "Jacobisplay", "]"}], " ", "//", " ", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.8787113957992067`*^9, 3.8787114033754263`*^9}, {
  3.878711530175087*^9, 3.878711531641437*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"7c1889cb-f4b4-4aa6-bffb-00da4445ba0f"],

Cell[TextData[{
 "Next, we consider the splay orbit in the full system, when ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"\[Delta]", "\[LongEqual]", "0"}], TraditionalForm], 
     "errors" -> {}, "input" -> "\\delta = 0", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8feb2587-0197-436c-a513-96076371bea6"],
 ". However, the output turns out to be too complicated."
}], "Text",
 CellChangeTimes->{{3.8787114766629744`*^9, 3.8787114947986317`*^9}, {
  3.878712341602775*^9, 
  3.878712372290659*^9}},ExpressionUUID->"99cbfbdc-88a8-4356-8746-\
389ba960aa2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rstar", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "+", 
        RowBox[{"4", "*", "K", "*", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Alpha]", "]"}], "/", "m"}]}]}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jacobifullsplay", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"FullRHS", " ", "/.", " ", 
        RowBox[{"\[Delta]", "->", " ", "0"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rads", "/.", " ", 
           RowBox[{"List", "->", " ", "Sequence"}]}], ",", " ", 
          RowBox[{"phis", "/.", " ", 
           RowBox[{"List", "->", " ", "Sequence"}]}]}], "}"}], "}"}]}], "]"}],
      " ", "/.", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"R", "[", "kk", "]"}], "->", " ", "Rstar"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}], " ", "/.", 
    " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", "kk", "]"}], "->", " ", 
       RowBox[{"\[Xi]", "+", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"kk", "/", "Num"}]}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", "Num"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Jacobifullsplay", " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"evals", " ", "=", " ", 
  RowBox[{"Eigenvalues", "[", "Jacobifullsplay", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8747388009194603`*^9, 3.8747388197314167`*^9}, {
   3.8747388751173286`*^9, 3.8747388964351*^9}, {3.8747391132638083`*^9, 
   3.874739170792975*^9}, {3.874739203265664*^9, 3.8747393386162777`*^9}, {
   3.874739369188829*^9, 3.874739421255988*^9}, {3.874739482517391*^9, 
   3.8747394872395372`*^9}, {3.8747405272101603`*^9, 3.874740528553094*^9}, {
   3.876997022707448*^9, 3.876997201568885*^9}, {3.876997239670292*^9, 
   3.876997243881789*^9}, {3.876997283599248*^9, 3.8769972840980673`*^9}, {
   3.876998197771804*^9, 3.876998217658888*^9}, {3.878710520566979*^9, 
   3.878710530629554*^9}, {3.8787108374370537`*^9, 3.87871086029993*^9}, {
   3.878711248384551*^9, 3.878711292177663*^9}, {3.8787115174734993`*^9, 
   3.878711517935788*^9}, {3.878712091823276*^9, 3.878712102589682*^9}, {
   3.8787121634500427`*^9, 3.8787121651724443`*^9}, 
   3.878712376388995*^9},ExpressionUUID->"d21e65f9-6bba-48dd-80dc-\
09bb8508c6ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further Calculations", "Section",
 CellChangeTimes->{{3.878705627569058*^9, 
  3.87870562992605*^9}},ExpressionUUID->"74c5b236-f679-4f16-a833-\
df0405e6e37e"],

Cell["\<\
This section contains further calculations, that do not belong in any of the \
above sections. Some of them have only be used for testing purposes.\
\>", "Text",
 CellChangeTimes->{{3.878705642742271*^9, 3.878705677767462*^9}, {
  3.878712417675269*^9, 
  3.878712431858349*^9}},ExpressionUUID->"52f987b2-5f00-4d87-8682-\
8f7cb87774ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numrep", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "->", ".1"}], ",", " ", 
     RowBox[{"\[Delta]", "->", ".1"}], ",", " ", 
     RowBox[{"\[Xi]", "->", ".1517"}], ",", " ", 
     RowBox[{"\[Alpha]", "->", 
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], "+", "0.05"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jacobi", " ", "/.", " ", "numrep"}], " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"expansionK1", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"floq", " ", "/.", " ", "numrep"}]}], "Input",
 CellChangeTimes->{{3.874660606173798*^9, 3.8746606088867064`*^9}, 
   3.8746725283204727`*^9, {3.874681411013227*^9, 3.874681434284108*^9}, {
   3.874681704611082*^9, 3.8746817552700777`*^9}, {3.8746820588676147`*^9, 
   3.8746820776093473`*^9}, {3.874682373768145*^9, 3.874682570764846*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"2f99543c-8c5f-41d9-9ed6-ea4eae51a50a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.003249923497676458`"}], "0.001624961748838229`", 
      "0.001624961748838229`"},
     {"0.001624961748838229`", 
      RowBox[{"-", "0.003249923497676458`"}], "0.001624961748838229`"},
     {"0.001624961748838229`", "0.001624961748838229`", 
      RowBox[{"-", "0.003249923497676458`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.874660609214551*^9, 3.8746725287298117`*^9, {3.874681415110654*^9, 
   3.874681427982367*^9}, {3.874681724700878*^9, 3.874681755536648*^9}, {
   3.874682069996366*^9, 3.874682078522189*^9}, 3.874682187273457*^9, 
   3.8746823002221622`*^9, {3.8746824114295063`*^9, 3.874682479747857*^9}, {
   3.8746825291039667`*^9, 3.8746825712310457`*^9}},
 CellLabel->
  "Out[325]//MatrixForm=",ExpressionUUID->"d2fda6cf-c600-4f7f-b6a8-\
e1ed3294177a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", "\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x11", "]"}], "-", 
              RowBox[{"Sin", "[", "x12", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x11", "]"}], "-", 
              RowBox[{"Sin", "[", "x13", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}]}]}], ")"}]}],
         "-", 
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"x11", "-", "x12", "-", "\[Alpha]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"x11", "-", "x13", "-", "\[Alpha]"}], "]"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{"x12", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"x11", "-", "x12", "+", "\[Alpha]"}], "]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", "\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x12", "]"}], "-", 
              RowBox[{"Sin", "[", "x13", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x12", "-", "x13", "-", "\[Alpha]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x11", "]"}], "-", 
              RowBox[{"Sin", "[", "x12", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x11", "-", "x12", "+", "\[Alpha]"}], "]"}]}]}], 
          ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"x11", "-", "x13", "+", "\[Alpha]"}], "]"}], "+", 
           RowBox[{"Sin", "[", 
            RowBox[{"x12", "-", "x13", "+", "\[Alpha]"}], "]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         FractionBox["1", "3"], " ", "K", " ", "\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x11", "]"}], "-", 
              RowBox[{"Sin", "[", "x13", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x11", "-", "x13", "+", "\[Alpha]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", "x12", "]"}], "-", 
              RowBox[{"Sin", "[", "x13", "]"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x12", "-", "x13", "+", "\[Alpha]"}], "]"}]}]}], 
          ")"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.874660609214551*^9, 3.8746725287298117`*^9, {3.874681415110654*^9, 
   3.874681427982367*^9}, {3.874681724700878*^9, 3.874681755536648*^9}, {
   3.874682069996366*^9, 3.874682078522189*^9}, 3.874682187273457*^9, 
   3.8746823002221622`*^9, {3.8746824114295063`*^9, 3.874682479747857*^9}, {
   3.8746825291039667`*^9, 3.874682571237853*^9}},
 CellLabel->
  "Out[326]//MatrixForm=",ExpressionUUID->"32d6eceb-d2ce-469f-8384-\
94e658f4cce0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.031901109358235`", ",", "1.031901109358235`", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.874660609214551*^9, 3.8746725287298117`*^9, {3.874681415110654*^9, 
   3.874681427982367*^9}, {3.874681724700878*^9, 3.874681755536648*^9}, {
   3.874682069996366*^9, 3.874682078522189*^9}, 3.874682187273457*^9, 
   3.8746823002221622`*^9, {3.8746824114295063`*^9, 3.874682479747857*^9}, {
   3.8746825291039667`*^9, 3.8746825712508183`*^9}},
 CellLabel->
  "Out[327]=",ExpressionUUID->"25129eba-f6d1-4679-b7d0-2e8b2908ba02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixExp", "[", 
   RowBox[{"a", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"Num", ",", "Num"}], "}"}]}], "]"}], "/", "Num"}], "-", 
      RowBox[{"IdentityMatrix", "[", "Num", "]"}]}], ")"}]}], "]"}], "//", 
  "Eigenvalues"}]], "Input",
 CellChangeTimes->{{3.8746831437184057`*^9, 3.874683192389064*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"51dcdc3f-058c-440a-82bf-32e720cef768"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "a"}]], ",", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", "a"}]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.874683175933647*^9, 3.8746831927860947`*^9}, 
   3.878712450905332*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"b2359944-4f92-4a2d-92ed-a80e5341e568"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ex", " ", "=", " ", 
  RowBox[{
   RowBox[{"8", "*", 
    RowBox[{"Sin", "[", "xk", "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", "xk", "]"}], "-", 
      RowBox[{"Sin", "[", "xl", "]"}]}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"xl", "-", "xk", "+", "\[Alpha]"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "0", "]"}], "[", 
       RowBox[{"xl", ",", " ", "xi"}], "]"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"s", "[", "0", "]"}], "[", 
       RowBox[{"xk", ",", "xi"}], "]"}]}], ")"}]}], " ", "//", " ", 
   "TrigReduce"}]}]], "Input",
 CellChangeTimes->{{3.873867251252355*^9, 3.8738672625435762`*^9}, {
   3.873867329593055*^9, 3.8738673326867332`*^9}, {3.873867783964282*^9, 
   3.873867796602456*^9}, {3.873867913099545*^9, 3.873867983269413*^9}, {
   3.873869350516836*^9, 3.873869356658799*^9}, 3.873869581469624*^9, {
   3.8738699999354477`*^9, 3.873870030184236*^9}, {3.8738705812154217`*^9, 
   3.873870611035657*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"ef1de34f-e01c-4ea9-b73e-b2837814817d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", "xk"}], "]"}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "+", "xk"}], "]"}], "+", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", 
    RowBox[{"3", " ", "xl"}]}], "]"}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "+", 
    RowBox[{"2", " ", "xk"}], "-", 
    RowBox[{"3", " ", "xl"}]}], "]"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "-", "xk", "-", 
     RowBox[{"2", " ", "xl"}]}], "]"}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "+", "xk", "-", 
     RowBox[{"2", " ", "xl"}]}], "]"}]}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "+", 
    RowBox[{"3", " ", "xk"}], "-", 
    RowBox[{"2", " ", "xl"}]}], "]"}], "-", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "-", "xl"}], "]"}]}], "+", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", 
    RowBox[{"2", " ", "xk"}], "-", "xl"}], "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "+", 
     RowBox[{"2", " ", "xk"}], "-", "xl"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "-", 
     RowBox[{"3", " ", "xk"}], "+", 
     RowBox[{"2", " ", "\[Alpha]"}]}], "]"}]}], "-", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "-", "xk", "+", 
     RowBox[{"2", " ", "\[Alpha]"}]}], "]"}]}], "+", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "+", "xk", "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}], "+", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", "xl", "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", 
    RowBox[{"2", " ", "xk"}], "-", "xl", "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "+", "xl", "+", 
     RowBox[{"2", " ", "\[Alpha]"}]}], "]"}]}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", 
    RowBox[{"4", " ", "xk"}], "+", "xl", "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"xi", "-", 
     RowBox[{"2", " ", "xk"}], "+", "xl", "+", 
     RowBox[{"2", " ", "\[Alpha]"}]}], "]"}]}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", 
    RowBox[{"3", " ", "xk"}], "+", 
    RowBox[{"2", " ", "xl"}], "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}], "+", 
  RowBox[{"Sin", "[", 
   RowBox[{"xi", "-", "xk", "+", 
    RowBox[{"2", " ", "xl"}], "+", 
    RowBox[{"2", " ", "\[Alpha]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.878713264979425*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"2269a5dc-439d-4484-9071-de444d18ddd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrigFactor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", "1", "]"}], "[", 
    RowBox[{"xk", ",", " ", "xl"}], "]"}], "/.", " ", 
   RowBox[{"\[Alpha]", "->", " ", "0"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.8732882728454437`*^9, 3.873288275963791*^9}, {
  3.873289115007214*^9, 3.873289123902424*^9}, {3.873289210999914*^9, 
  3.873289239613481*^9}, {3.873289318734448*^9, 3.8732893247566338`*^9}, {
  3.87871327712001*^9, 3.878713295014842*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a8d5af49-0fc2-4734-a718-3ac62622558c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", 
    RowBox[{
     FractionBox["xk", "2"], "-", 
     FractionBox["xl", "2"]}], "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "\[Omega]", " ", 
     RowBox[{"Cos", "[", "xk", "]"}]}], "-", 
    RowBox[{"\[Omega]", " ", 
     RowBox[{"Cos", "[", "xl", "]"}]}], "+", 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{"Sin", "[", "xk", "]"}]}], "-", 
    RowBox[{"m", " ", 
     RowBox[{"Sin", "[", "xl", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8732882763260527`*^9, 3.873288809504849*^9, 3.873289027569046*^9, 
   3.873289124254958*^9, {3.8732892135490637`*^9, 3.8732892402814617`*^9}, 
   3.873289325492495*^9, {3.87871328275771*^9, 3.8787132956385736`*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"f54ca8ee-3b6e-462e-b436-23b4f93142a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920., 1041.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"baff41c3-5043-4ecf-b219-626edd71c32f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 98, "Title",ExpressionUUID->"fbcab9dd-becd-415f-bdb5-118a66361846"],
Cell[746, 27, 202, 3, 32, "Author",ExpressionUUID->"62632b38-10ac-4132-bbd7-03f58be76396"],
Cell[951, 32, 328, 7, 35, "Text",ExpressionUUID->"ec42298c-7030-48c4-baf5-1c85d981c792"],
Cell[CellGroupData[{
Cell[1304, 43, 160, 3, 68, "Section",ExpressionUUID->"bf98f58a-cd45-489b-ac9e-52f01f7ee1a3"],
Cell[1467, 48, 660, 15, 35, "Text",ExpressionUUID->"e32d75b3-9834-46bf-838f-e35ae84105c6"],
Cell[2130, 65, 13079, 280, 255, "Input",ExpressionUUID->"ba178e41-f9a1-4da6-a62b-0497915708ca"],
Cell[15212, 347, 1629, 48, 41, "Text",ExpressionUUID->"5ec3d5cb-ef72-4217-bab0-ab8d59f0d836"],
Cell[16844, 397, 9337, 169, 435, "Input",ExpressionUUID->"33c9064d-8cbb-4ce0-b229-8d65650ba6d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26218, 571, 161, 3, 68, "Section",ExpressionUUID->"520485af-971a-404f-985f-180c1aa57d01"],
Cell[26382, 576, 2162, 58, 87, "Text",ExpressionUUID->"24f8461c-2a3e-486f-a2c4-976bc9336e4b"],
Cell[CellGroupData[{
Cell[28569, 638, 12862, 278, 494, "Input",ExpressionUUID->"b70aa1f2-c650-439c-acd6-8882249bf291"],
Cell[CellGroupData[{
Cell[41456, 920, 305, 6, 25, "Print",ExpressionUUID->"83020f8f-b945-454d-840c-62096f43cd1d"],
Cell[41764, 928, 959, 26, 59, "Print",ExpressionUUID->"f3706fcc-6b56-4b57-a3d0-6238c276aa46"],
Cell[42726, 956, 227, 6, 23, "Print",ExpressionUUID->"d855396f-e2ac-47d8-b606-fee7466574eb"],
Cell[42956, 964, 325, 9, 23, "Print",ExpressionUUID->"60d7f482-e86b-493f-95b5-7f8a5564f32e"],
Cell[43284, 975, 305, 6, 25, "Print",ExpressionUUID->"ef693343-7d71-49d6-b381-fd811ff3a1d0"],
Cell[43592, 983, 3488, 91, 98, "Print",ExpressionUUID->"bcd83fa3-36b1-4630-a395-300765464377"],
Cell[47083, 1076, 230, 6, 23, "Print",ExpressionUUID->"ab7da78c-31ee-4672-aff8-341f63ecebbb"],
Cell[47316, 1084, 1429, 40, 25, "Print",ExpressionUUID->"7cc77904-e400-4ee0-8116-10165fc40b57"],
Cell[48748, 1126, 305, 6, 25, "Print",ExpressionUUID->"e0d4c457-0db6-4885-9dd2-80d932da5707"],
Cell[49056, 1134, 11573, 286, 203, "Print",ExpressionUUID->"5e513cc2-3a8d-4537-90d9-2f490637c368"],
Cell[60632, 1422, 230, 6, 23, "Print",ExpressionUUID->"ead4c319-7b23-44e0-b402-5fdce7a0be87"],
Cell[60865, 1430, 5541, 156, 66, "Print",ExpressionUUID->"df6794d6-2cb3-4a23-b6d7-4ad64e8193e4"]
}, Open  ]]
}, Open  ]],
Cell[66433, 1590, 1954, 58, 62, "Text",ExpressionUUID->"2b469c5c-93ac-4aa0-8fc7-df4f1e450e8a"],
Cell[68390, 1650, 7382, 211, 123, "Input",ExpressionUUID->"d5c12862-3d8a-49c5-8200-50e443d07110"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75809, 1866, 160, 3, 68, "Section",ExpressionUUID->"8f6f50c8-1ffb-4f81-b067-06f13de465e2"],
Cell[75972, 1871, 1388, 25, 81, "Text",ExpressionUUID->"38a26139-86cf-4d13-9d6a-ce9ea0623044"],
Cell[77363, 1898, 292, 7, 54, "Input",ExpressionUUID->"0fa86862-6971-4e16-9331-f8f82a24bc5f"],
Cell[CellGroupData[{
Cell[77680, 1909, 195, 3, 54, "Subsection",ExpressionUUID->"9361b0a9-cade-4abe-b725-bf8a84269af9"],
Cell[77878, 1914, 698, 16, 58, "Text",ExpressionUUID->"ade9f6b4-7fb2-43ae-b72c-8aa04fcf356e"],
Cell[78579, 1932, 1137, 23, 54, "Input",ExpressionUUID->"087cc9a8-8cf5-4220-b4c7-603798a455f3"],
Cell[79719, 1957, 366, 9, 35, "Text",ExpressionUUID->"f8ef5d93-b359-4934-8d6b-0ad29cb0169e"],
Cell[80088, 1968, 671, 17, 54, "Input",ExpressionUUID->"35774516-7213-43d2-bcb5-95becd214c63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80796, 1990, 197, 3, 54, "Subsection",ExpressionUUID->"5d585a70-c862-48e6-a7b2-6108773e31de"],
Cell[80996, 1995, 417, 8, 35, "Text",ExpressionUUID->"61fb6d99-b7d3-4b3d-afda-fa1171b3f066"],
Cell[CellGroupData[{
Cell[81438, 2007, 479, 12, 47, "Subsubsection",ExpressionUUID->"b3c363b1-2bd2-4361-9f88-a76ac5845b86"],
Cell[81920, 2021, 1455, 39, 36, "Text",ExpressionUUID->"863cdb4d-e516-48b8-83e3-a2cd5f6cc3fe"],
Cell[83378, 2062, 1977, 52, 101, "Input",ExpressionUUID->"0e076688-be1c-4ab3-9c9c-e893b7c5f1a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85392, 2119, 453, 12, 47, "Subsubsection",ExpressionUUID->"b0895d4a-2054-48a1-8896-306feb2aa157"],
Cell[85848, 2133, 1728, 44, 36, "Text",ExpressionUUID->"ca2d2364-800e-4bea-b21c-a450916e968b"],
Cell[87579, 2179, 1977, 52, 101, "Input",ExpressionUUID->"f1019009-c8a0-495d-a6c1-db0bb057fab6"],
Cell[89559, 2233, 1187, 31, 36, "Text",ExpressionUUID->"638a2ef7-c74c-430a-9b91-63a6dc345c58"],
Cell[90749, 2266, 2120, 56, 101, "Input",ExpressionUUID->"7244a9d2-cc98-4b13-93a0-f53d7c057673"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92906, 2327, 454, 12, 47, "Subsubsection",ExpressionUUID->"a52f0fbb-27bc-45b8-943c-f63663761714"],
Cell[93363, 2341, 1835, 48, 36, "Text",ExpressionUUID->"b5f2f1c7-61b9-431f-8d0f-8913015e2b83"],
Cell[95201, 2391, 2023, 53, 101, "Input",ExpressionUUID->"1d84c776-8549-4dc0-a386-0b9fe9740b29"],
Cell[97227, 2446, 977, 27, 36, "Text",ExpressionUUID->"59752014-f2be-468e-a1e3-eade3b4dd51b"],
Cell[98207, 2475, 2269, 58, 101, "Input",ExpressionUUID->"9bad1a4f-b350-454c-ac87-225fcc2ef0da"],
Cell[100479, 2535, 1152, 29, 36, "Text",ExpressionUUID->"01da16c4-cb19-47dc-b3fe-f7081fcb72c2"],
Cell[101634, 2566, 2261, 59, 101, "Input",ExpressionUUID->"293cefdc-eafb-4f6a-bc26-73a26074364c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[103956, 2632, 155, 3, 68, "Section",ExpressionUUID->"5cf7ad3f-27cd-41fb-8524-41f5a5e2ca4b"],
Cell[104114, 2637, 1512, 38, 36, "Text",ExpressionUUID->"f299dace-3ed4-47b2-8fb2-d63baeacad3c"],
Cell[105629, 2677, 3387, 90, 100, "Input",ExpressionUUID->"e8a5c974-383d-4622-8791-e81b1ef36e1b"],
Cell[109019, 2769, 643, 15, 36, "Text",ExpressionUUID->"5493c18c-70e0-4388-9a43-2d4786977281"],
Cell[109665, 2786, 6840, 184, 236, "Input",ExpressionUUID->"b63489f6-e411-4a62-be34-9c7f5c8f1f67"],
Cell[116508, 2972, 585, 14, 36, "Text",ExpressionUUID->"fc5bd3a6-80b5-4bb4-9ba8-9922b432c7a1"],
Cell[117096, 2988, 502, 10, 32, "Input",ExpressionUUID->"834371c4-f0a7-40b3-bc6f-ace05ce8e603"],
Cell[117601, 3000, 260, 6, 35, "Text",ExpressionUUID->"8ee2416c-4708-44c6-8ccb-22350ed6988b"],
Cell[117864, 3008, 5332, 143, 146, "Input",ExpressionUUID->"965e2e08-3cf7-4135-b5bd-f839b85f111f"],
Cell[CellGroupData[{
Cell[123221, 3155, 165, 3, 54, "Subsection",ExpressionUUID->"d70dbfd9-85a4-43c5-b843-8ccef8a5e53b"],
Cell[123389, 3160, 1107, 27, 59, "Text",ExpressionUUID->"c8b9daf9-ca03-496d-9650-53345fd599bf"],
Cell[124499, 3189, 1328, 35, 77, "Input",ExpressionUUID->"24d340e0-aeb4-4959-8b6e-959743b1faf1"],
Cell[125830, 3226, 1160, 25, 59, "Text",ExpressionUUID->"d3de88e0-240e-43bb-ba14-3c9e97c61a1c"],
Cell[126993, 3253, 2876, 79, 142, "Input",ExpressionUUID->"5ed6614b-2b7a-41e6-901f-0533f935e2d4"],
Cell[129872, 3334, 859, 18, 36, "Text",ExpressionUUID->"31a3f5bc-f845-4b0f-b7e2-8f1f0a029798"],
Cell[130734, 3354, 3132, 86, 165, "Input",ExpressionUUID->"55d0805b-2598-495d-aa43-af5e385d1bc9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133903, 3445, 161, 3, 54, "Subsection",ExpressionUUID->"8a1a7cee-fa57-4ef2-a958-20bb88734c58"],
Cell[134067, 3450, 585, 14, 36, "Text",ExpressionUUID->"d940d9dc-2eb5-4ad5-8867-c7e5d25d2005"],
Cell[134655, 3466, 993, 26, 54, "Input",ExpressionUUID->"7c1889cb-f4b4-4aa6-bffb-00da4445ba0f"],
Cell[135651, 3494, 636, 14, 36, "Text",ExpressionUUID->"99cbfbdc-88a8-4356-8746-389ba960aa2d"],
Cell[136290, 3510, 2632, 63, 97, "Input",ExpressionUUID->"d21e65f9-6bba-48dd-80dc-09bb8508c6ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138971, 3579, 164, 3, 68, "Section",ExpressionUUID->"74c5b236-f679-4f16-a833-df0405e6e37e"],
Cell[139138, 3584, 346, 7, 35, "Text",ExpressionUUID->"52f987b2-5f00-4d87-8682-8f7cb87774ff"],
Cell[CellGroupData[{
Cell[139509, 3595, 1008, 22, 97, "Input",ExpressionUUID->"2f99543c-8c5f-41d9-9ed6-ea4eae51a50a"],
Cell[140520, 3619, 1231, 29, 80, "Output",ExpressionUUID->"d2fda6cf-c600-4f7f-b6a8-e1ed3294177a"],
Cell[141754, 3650, 4523, 121, 107, "Output",ExpressionUUID->"32d6eceb-d2ce-469f-8384-94e658f4cce0"],
Cell[146280, 3773, 570, 11, 33, "Output",ExpressionUUID->"25129eba-f6d1-4679-b7d0-2e8b2908ba02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146887, 3789, 536, 14, 29, "Input",ExpressionUUID->"51dcdc3f-058c-440a-82bf-32e720cef768"],
Cell[147426, 3805, 374, 9, 36, "Output",ExpressionUUID->"b2359944-4f92-4a2d-92ed-a80e5341e568"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147837, 3819, 1114, 26, 33, "Input",ExpressionUUID->"ef1de34f-e01c-4ea9-b73e-b2837814817d"],
Cell[148954, 3847, 2621, 77, 59, "Output",ExpressionUUID->"2269a5dc-439d-4484-9071-de444d18ddd0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151612, 3929, 566, 11, 33, "Input",ExpressionUUID->"a8d5af49-0fc2-4734-a718-3ac62622558c"],
Cell[152181, 3942, 864, 22, 48, "Output",ExpressionUUID->"f54ca8ee-3b6e-462e-b436-23b4f93142a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

